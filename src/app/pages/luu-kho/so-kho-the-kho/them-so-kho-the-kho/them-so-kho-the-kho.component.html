<div class="bg-trang">
  <form nz-form [formGroup]="formData" [nzLayout]="'vertical'">
    <nz-alert class="mg-t-10"
              *ngIf="formData.value.trangThai == STATUS.TU_CHOI_KT || formData.value.trangThai == STATUS.TU_CHOI_LDCC"
              nzShowIcon nzType="error" nzMessage="Lý do từ chối" nzDescription="{{formData.value.lyDoTuChoi}}">
    </nz-alert>
    <div nz-row [nzGutter]="24">
      <div nz-col [nzSpan]="10">
        <nz-form-item class="form-item">
          <nz-form-control>
            <nz-radio-group formControlName="loai" (ngModelChange)="changeLoai()">
              <label nz-radio *ngFor="let item of listType" [nzDisabled]="idInput && idInput >0"
                [nzValue]="item.ma">{{item.giaTri}}</label>
            </nz-radio-group>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>
    <nz-card class="mt16 flex-card p-lr16 mg-t-10" *ngIf="formData.value.loai == '00'">
      <div nz-row [nzGutter]="18">
        <div nz-col [nzSpan]="3">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" nzRequired>Năm</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-input-group>
                <nz-select formControlName="nam" nzDisabled>
                  <nz-option *ngFor="let p of listNam" [nzValue]="p.value" [nzLabel]="p.text"></nz-option>
                </nz-select>
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="9">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Người lập sổ</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="nguoiLap" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Tên đơn vị</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="tenDvi" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Kế toán trưởng</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="keToanTruong" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Thủ trưởng đơn vị (Lãnh đạo Chi cục)</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="thuTruong" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Điểm kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="maDiemKho" (ngModelChange)="onChangeDiemKho($event)"
                [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsDiemKho" [nzValue]="item.maDvi" [nzLabel]="item.tenDvi">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Nhà kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="maNhaKho" (ngModelChange)="onChangeNhaKho($event)" [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsNhaKho" [nzValue]="item.maDvi" [nzLabel]="item.tenDvi">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Ngăn kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="maNganKho" (ngModelChange)="onChangeNganKho($event)"
                [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsNganKho" [nzValue]="item.maDvi" [nzLabel]="item.tenDvi">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Lô kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="maLoKho" (ngModelChange)="onChangeLoKho($event)" [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsLoKho" [nzValue]="item.maDvi" [nzLabel]="item.tenDvi">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Loại hàng DTQG</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-input-group>
                <input nz-input formControlName="tenLoaiVthh" readonly class="text-blue">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Chủng loại hàng</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input formControlName="tenCloaiVthh" readonly class="text-blue">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Đơn vị tính</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input formControlName="donViTinh" readonly class="text-blue">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Tên hàng DTQG</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="tenHangHoa">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Tồn kho</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input formControlName="slTon" readonly class="money-input" currencyMask [options]="amount">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Tích luợng khả dụng</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input formControlName="tichLuongKd" readonly class="money-input" currencyMask
                  [options]="amount">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Tích lượng theo thiết kế</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input formControlName="tichLuongTk" readonly class="money-input" currencyMask
                  [options]="amount">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
        </div>

      </div>
    </nz-card>
    <nz-card class="mt16 flex-card p-lr16 mg-t-10" *ngIf="formData.value.loai == '00'">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="3">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true" nzRequired>Số sổ kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-input-group>
                <input type="text" nz-input formControlName="so" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="8">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true" nzRequired>Tên sổ kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-input-group>
                <input type="text" nz-input formControlName="ten" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="3">
          <nz-form-item class="form-item">
            <nz-form-label nzRequired [nzNoColon]="true">Ngày mở sổ</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-input-group>
                <nz-date-picker formControlName="ngayMo" nzFormat="dd/MM/yyyy"></nz-date-picker>
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="3">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true"></nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <label class="font-weight-bold" nz-checkbox formControlName="isDongSo" [nzDisabled]="true">Đóng
                  sổ</label>
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="6">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true">Ngày đóng sổ</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <nz-date-picker class="search__input" formControlName="ngayDong"
                  [nzDisabled]="true"
                  nzFormat="dd/MM/yyyy"></nz-date-picker>
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </nz-card>
    <nz-card class="mt16 flex-card p-lr16 mg-t-10" *ngIf="formData.value.loai == '01'">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="2">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" nzRequired>Năm</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-input-group>
                <nz-select formControlName="nam" nzDisabled>
                  <nz-option *ngFor="let p of listNam" [nzValue]="p.value" [nzLabel]="p.text"></nz-option>
                </nz-select>
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="5">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Điểm kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="maDiemKho" (ngModelChange)="onChangeDiemKho($event)"
                [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsDiemKho" [nzValue]="item.maDvi" [nzLabel]="item.tenDvi">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="5">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Nhà kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="maNhaKho" (ngModelChange)="onChangeNhaKho($event)" [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsNhaKho" [nzValue]="item.maDvi" [nzLabel]="item.tenDvi">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Ngăn kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="maNganKho" (ngModelChange)="onChangeNganKho($event)"
                [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsNganKho" [nzValue]="item.maDvi" [nzLabel]="item.tenDvi">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Lô kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="maLoKho" (ngModelChange)="onChangeLoKho($event)" [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsLoKho" [nzValue]="item.maDvi" [nzLabel]="item.tenDvi">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="20">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true" nzRequired>Tên sổ kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="idSoKho" (ngModelChange)="onChangeSoKho($event)"  [nzDisabled]="idInput > 0">
                <nz-option *ngFor="let item of dsSoKho" [nzValue]="item.id" [nzLabel]="item.ten">
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true">Ngày mở sổ</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <nz-date-picker nzDisabled formControlName="ngayMoSoKho" nzFormat="dd/MM/yyyy"></nz-date-picker>
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Người lập sổ</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="nguoiLap" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Tên đơn vị</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="tenDvi" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Kế toán trưởng</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="keToanTruong" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Thủ trưởng đơn vị (Lãnh đạo Chi cục)</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="thuTruong" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Loại hàng DTQG</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="tenLoaiVthh" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Chủng loại hàng</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="tenCloaiVthh" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Đơn vị tính</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input type="text" nz-input formControlName="donViTinh" readonly />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Tồn kho</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input formControlName="slTon" readonly class="money-input" currencyMask [options]="amount">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Tích luợng khả dụng</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input formControlName="tichLuongKd" readonly class="money-input" currencyMask
                  [options]="amount">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Tích lượng theo thiết kế</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input formControlName="tichLuongTk" readonly class="money-input" currencyMask
                  [options]="amount">
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
        </div>

      </div>
    </nz-card>
    <nz-card class="mt16 flex-card p-lr16 mg-t-10" *ngIf="formData.value.loai == '01'">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="3">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true" nzRequired>Số thẻ kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-input-group>
                <input type="text" nz-input formControlName="so" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="8">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true" nzRequired>Tên thẻ kho</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-input-group>
                <input type="text" nz-input formControlName="ten" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="12">
          <nz-form-item class="form-item">
            <nz-form-label [nzNoColon]="true" nzRequired>Ngày tạo</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <div nz-row>
                <div nz-col nzSpan="11">
                  <nz-date-picker nzPlaceHolder="Ngày tạo từ" formControlName="ngayTaoTu" nzFormat="dd/MM/yyyy"
                    class="search__input"></nz-date-picker>
                </div>
                <div nz-col nzSpan="1">
                </div>
                <div nz-col nzSpan="11">
                  <nz-date-picker nzPlaceHolder="Ngày tạo đến" formControlName="ngayTaoDen" nzFormat="dd/MM/yyyy"
                    class="search__input"></nz-date-picker>
                </div>
              </div>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </nz-card>
  </form>
</div>

<div class="modal-footer">
  <div class="nut">
    <div class="cantrai">
    </div>
    <div class="canphai">
      <button type="button" class="btn btn-do" *ngIf="formData.value.trangThai == STATUS.DU_THAO && this.formData.value.id"
              (click)="delete(this.formData.value)">
        <i class="fa fa-trash-o do" title="Xóa bản ghi"></i>
        <span>Xóa</span>
      </button>
      <button type="button" class="btn btn-sub xanh-nhat ml-2"
        (click)="save(true)"
        *ngIf="showSave()">
        <i class="icon htvbdh_tcdt_print"></i>
        <span>Lưu và gửi duyệt</span>
      </button>
      <button type="button" class="btn btn-sub xanh ml-2" (click)="save()"
        *ngIf="showSave()">
        <i class="fa fa-save"></i>
        <span>Lưu</span>
      </button>
      <button type="button" class="btn btn-sub btn-xoa ml-2" (click)="tuChoi()"
              *ngIf="showPheDuyetTuChoi()">
        <i class="icon htvbdh_tcdt_tuchoi"></i>
        <span>Từ chối</span>
      </button>
      <button type="button" class="btn btn-sub xanh-nhat ml-2" (click)="pheDuyet()"
              *ngIf="showPheDuyetTuChoi() || showDongSo() ">
        <i class="icon htvbdh_dakyduyet"></i>
        <span>{{ showDongSo() ? 'Đóng sổ' : 'Duyệt'}}</span>
      </button>
      <button type="button" class="btn btn-sub" (click)="quayLai()">
        <i nz-icon nzType="close-circle" nzTheme="fill" class="icon-cancel"></i>
        <span>Đóng</span>
      </button>
    </div>
  </div>
</div>
<ng-template #error let-control>
  <ng-container *ngIf="control.hasError('required')">{{globals.prop.REQUIRED}}</ng-container>
</ng-template>
