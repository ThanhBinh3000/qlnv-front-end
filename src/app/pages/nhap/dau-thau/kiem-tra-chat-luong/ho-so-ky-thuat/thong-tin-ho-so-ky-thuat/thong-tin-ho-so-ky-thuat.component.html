<nz-affix [nzOffsetTop]="globals.prop.MENU_LV1" class="btn-affix">
  <div class="btn-group">
    <a type="button" class="btn btn-sub" (click)="back()">
      <i class="fa fa-arrow-left"></i>
      <span>Quay lại</span>
    </a>
    <button type="button" class="btn btn-sub" (click)="print()">
      <i class="icon htvbdh_tcdt_print"></i>
      <span>In</span>
    </button>
    <button type="button" class="btn btn-sub" *ngIf="!isDisableField() && !isView"
            (click)="guiDuyet()">
      <i class="icon htvbdh_tcdt_guiduyet"></i>
      <span>Lưu và gửi duyệt</span>
    </button>
    <button type="button" class="btn btn-sub"
            *ngIf="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_CHI_CUC"
            (click)="pheDuyet()">
      <i class="icon htvbdh_tcdt_pheduyet"></i>
      <span>Duyệt</span>
    </button>
    <a type="button" class="btn btn-sub"
       *ngIf="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_CHI_CUC"
       (click)="tuChoi()">
      <i class="icon htvbdh_tcdt_tuchoi do"></i>
      <span>Từ chối</span>
    </a>
    <button type="button" class="btn btn-sub" *ngIf="!isDisableField() && !isView"
            (click)="save(false)">
      <i class="icon  htvbdh_tcdt_save"></i>
      <span>Lưu</span>
    </button>
  </div>
</nz-affix>

<div class="bg-trang">
  <nz-card nzTitle="" class="flex-card p-lr16">
  <div class="header">
    <div class="header-text">
      <div class="title-chi-tieu">
        <span [ngClass]="thongTinTrangThai(detail.trangThai)">{{detail.tenTrangThai}}</span>
        <span>Tạo hồ sơ kỹ thuật nhập vật tư</span>
        <span>Thông tin đề xuất kế hoạch lực chọn nhà thầu</span>
      </div>
    </div>
  </div>
  </nz-card>
  <nz-card nzTitle="" class="flex-card p-lr16">
    <div class="search__body" nz-row [nzGutter]="[18, 6]">
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số quyết định nhập
          </nz-form-label>
          <nz-select [(ngModel)]="detail.qdgnvnxId" (ngModelChange)="changeSoQuyetDinh(false)"
                     [disabled]="isDisableField() || isView">
            <nz-option *ngFor="let item of listSoQuyetDinh" [nzValue]="item.id" [nzLabel]="item.soQd">
            </nz-option>
          </nz-select>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số biên bản bàn giao mẫu
          </nz-form-label>
          <nz-select [(ngModel)]="detail.bienBanGiaoMauId" (ngModelChange)="changeBanGiaoMau()"
                     [disabled]="isDisableField() || isView">
            <nz-option *ngFor="let item of listBanGiaoMau" [nzValue]="item.id" [nzLabel]="item.soBienBan">
            </nz-option>
          </nz-select>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8"></div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Đơn vị
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.tenDvi" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Mã QHNS
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.maDvi" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số biên bản
          </nz-form-label>
          <input nz-input placeholder="Nhập số biên bản" [(ngModel)]="detail.soBienBan" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Loại hàng
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.tenVthh" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số hợp đồng
          </nz-form-label>
          <nz-select [(ngModel)]="detail.soHopDong" (ngModelChange)="changeHopDong()"
                     [disabled]="isDisableField() || isView">
            <nz-option *ngFor="let item of listHopDong" [nzValue]="item.hopDong.soHd"
                       [nzLabel]="item.hopDong.soHd">
            </nz-option>
          </nz-select>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Ngày hợp đồng
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.ngayHopDong" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Đơn vị cung cấp hàng
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.donViCungCap" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Ngày kiểm tra
          </nz-form-label>
          <nz-date-picker class="search__input" [nzDisabledDate]="" nzFormat="yyyy-MM-dd"
                          [(ngModel)]="detail.ngayKiemTra" [disabled]="isDisableField() || isView">
          </nz-date-picker>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Địa điểm kiểm tra
          </nz-form-label>
          <input placeholder="Nhập địa điểm lấy mẫu" nz-input [(ngModel)]="detail.diaDiemKiemTra"
                 [disabled]="isDisableField() || isView" />
        </nz-form-item>
      </div>
    </div>
  </nz-card>
  <nz-card nzTitle="" class="flex-card p-lr16 phieu-kiem-nghiem">
    <div class="search__body" nz-row [nzGutter]="[18, 6]">
      <div nz-col nzSpan="24">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true" class="title-form-chi-tiet">
            1. Thành phần kiểm tra
          </nz-form-label>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item class="d-flex flex-column">
          <nz-form-label [nzNoColon]="true" class="d-flex">
            Đại diện cục dữ trữ nhà nước
          </nz-form-label>
          <div class="pd-b-16 d-flex" *ngFor="let item of listDaiDienCuc;let i = index">
            <input nz-input [(ngModel)]="item.daiDien" [disabled]="isDisableField() || isView || i != 0" />
            <div class="btn-plus" *ngIf="i == 0 && !(isDisableField() || isView)" (click)="addDaiDien(capCuc)">
              <i class="icon htvbdh_dau-cong"></i>
            </div>
            <div class="btn-plus" *ngIf="i != 0 && !(isDisableField() || isView)" (click)="xoaDaiDien(item)">
              <i class="fa fa-trash-o do"></i>
            </div>
          </div>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item class="d-flex flex-column">
          <nz-form-label [nzNoColon]="true" class="d-flex">
            Đại diện chi cục dữ trữ nhà nước
          </nz-form-label>
          <div class="pd-b-16 d-flex" *ngFor="let item of listDaiDienChiCuc;let i = index">
            <input nz-input [(ngModel)]="item.daiDien" [disabled]="isDisableField() || isView || i != 0" />
            <div class="btn-plus" *ngIf="i == 0 && !(isDisableField() || isView)" (click)="addDaiDien(capChiCuc)">
              <i class="icon htvbdh_dau-cong"></i>
            </div>
            <div class="btn-plus" *ngIf="i != 0 && !(isDisableField() || isView)" (click)="xoaDaiDien(item)">
              <i class="fa fa-trash-o do"></i>
            </div>
          </div>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item class="d-flex flex-column">
          <nz-form-label [nzNoColon]="true" class="d-flex">
            Đại diện đơn vị cung cấp
          </nz-form-label>
          <div class="pd-b-16 d-flex" *ngFor="let item of listDaiDienDonVi;let i = index">
            <input nz-input [(ngModel)]="item.daiDien" [disabled]="isDisableField() || isView || i != 0" />
            <div class="btn-plus" *ngIf="i == 0 && !(isDisableField() || isView)" (click)="addDaiDien(capDonVi)">
              <i class="icon htvbdh_dau-cong"></i>
            </div>
            <div class="btn-plus" *ngIf="i != 0 && !(isDisableField() || isView)" (click)="xoaDaiDien(item)">
              <i class="fa fa-trash-o do"></i>
            </div>
          </div>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="24">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true" class="title-form-chi-tiet">
            2. Nội dung kiểm tra hồ sơ kỹ thuật
          </nz-form-label>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="4">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Tên hàng
          </nz-form-label>
          <!-- <nz-input-group nzAddOnAfterIcon="folder-open" (click)="selectHangHoa()"> -->
          <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenVatTuCha"
                 readonly="true" />
          <!-- </nz-input-group> -->
        </nz-form-item>
      </div>
      <div nz-col nzSpan="4">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Chủng loại hàng
          </nz-form-label>
          <!-- <nz-input-group nzAddOnAfterIcon="folder-open" (click)="selectHangHoa()"> -->
          <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenVatTu" readonly="true" />
          <!-- </nz-input-group> -->
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số lượng thực nhập
          </nz-form-label>
          <nz-input-number type="text" nz-input [disabled]="isDisableField() || isView" [nzSize]="'small'"
                           [(ngModel)]="detail.soLuongThucNhap" [nzMin]="0" [nzMax]="globals.prop.MAX_INPUT">
          </nz-input-number>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Thời gian nhập
          </nz-form-label>
          <nz-date-picker nzShowTime nzFormat="yyyy-MM-dd HH:mm:ss" [(ngModel)]="detail.thoiGianNhap"
                          [disabled]="isDisableField() || isView">
          </nz-date-picker>
        </nz-form-item>
      </div>
    </div>
    <div class="comment-last" nz-row [nzGutter]="[18, 6]">
      <div nz-col nzSpan="24">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Căn cứ
          </nz-form-label>
          <div class="list-file">
            <file-list [data]="listCanCu" [disabled]="isDisableField() || isView">
            </file-list>
          </div>
        </nz-form-item>
      </div>
    </div>
    <div nz-col nzSpan="24">
      <nz-form-item>
        <nz-form-label [nzNoColon]="true" class="title-form-chi-tiet">
          3. Kết luận
        </nz-form-label>
      </nz-form-item>
    </div>
    <div nz-col nzSpan="24">
      <nz-form-item class="d-flex flex-column">
        <nz-form-label [nzNoColon]="true" class="d-flex">
          Kết luận
        </nz-form-label>
        <textarea nz-input [rows]="3" [(ngModel)]="detail.ketLuan"
                  placeholder="Nhập nội dung kết luận"></textarea>
      </nz-form-item>
    </div>
  </nz-card>
</div>

