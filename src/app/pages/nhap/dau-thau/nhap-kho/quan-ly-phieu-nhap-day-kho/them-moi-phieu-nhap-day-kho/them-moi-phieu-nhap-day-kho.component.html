<nz-affix class="btn-affix" [nzOffsetTop]="globals.prop.MENU_LV2">
  <div class="btn-group">
    <button class="btn btn-sub" (click)="back()">
      <i class="fa fa-arrow-left"></i>
      <span>Quay lại</span>
    </button>
    <button class="btn btn-sub" *ngIf="!isDisableField() && !isView" (click)="guiDuyet()">
      <i class="icon htvbdh_tcdt_guiduyet"></i>
      <span>Lưu và gửi duyệt</span>
    </button>
    <button class="btn btn-sub"
      *ngIf="detail.trangThai == globals.prop.NHAP_CHO_DUYET_KTV_BAO_QUAN || detail.trangThai == globals.prop.NHAP_CHO_DUYET_KE_TOAN || detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_CHI_CUC"
      (click)="pheDuyet()">
      <i class="icon htvbdh_tcdt_pheduyet"></i>
      <span>Duyệt</span>
    </button>
    <button class="btn btn-sub"
      *ngIf="detail.trangThai == globals.prop.NHAP_CHO_DUYET_KTV_BAO_QUAN || detail.trangThai == globals.prop.NHAP_CHO_DUYET_KE_TOAN || detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_CHI_CUC"
      (click)="tuChoi()">
      <i class="icon htvbdh_tcdt_tuchoi do"></i>
      <span>Từ chối</span>
    </button>
    <button class="btn btn-sub xanh" *ngIf="!isDisableField() && !isView" (click)="save(false)">
      <i class="icon  htvbdh_tcdt_save"></i>
      <span>Lưu</span>
    </button>
  </div>
</nz-affix>
<div class="btn-trang">
  <div class="header">
    <div class="header-text">
      <div class="title-chi-tieu">
        <span *ngIf="id === 0" class="du-thao-va-lanh-dao-duyet">
          Dự Thảo
        </span>
        <span *ngIf="id > 0" [ngClass]="thongTinTrangThai(detail.trangThai)">{{detail.tenTrangThai}}</span>
        <span class="title-form">Biên bản nhập đầy kho</span>
      </div>
    </div>
  </div>

  <nz-card nzTitle="" class="mt16 flex-card p-lr16">
    <div class="search__body" nz-row [nzGutter]="[18, 6]">
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Số quyết định nhập
          </nz-form-label>
          <nz-select [(ngModel)]="detail.qdgnvnxId" (ngModelChange)="changeSoQuyetDinh(false)"
            [disabled]="isDisableField() || isView">
            <nz-option *ngFor="let item of listSoQuyetDinh" [nzValue]="item.id" [nzLabel]="item.soQd">
            </nz-option>
          </nz-select>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="4">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Số biên bản nghiệm thu bảo quản
          </nz-form-label>
          <nz-select [(ngModel)]="detail.bbNghiemThuId" (ngModelChange)="changeBienBanNghiemThu()"
            [disabled]="isDisableField() || isView">
            <nz-option *ngFor="let item of bbNghiemThuBaoQuans" [nzValue]="item.id" [nzLabel]="item.soBb">
            </nz-option>
          </nz-select>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Đơn vị
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.tenDvi" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Mã QHNS
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.tenDvi" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Số biên bản
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.soBienBan" placeholder="Nhập số biên bản" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Ngày nhập đầy kho
          </nz-form-label>
          <nz-date-picker class="search__input" nzFormat="yyyy-MM-dd" nzPlaceHolder="Ngày nhập đầy kho"
            [(ngModel)]="detail.ngayNhapDayKho" [disabled]="isDisableField() || isView">
          </nz-date-picker>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="4">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Thủ trưởng đơn vị
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.thuTruong" placeholder="Nhập tên thủ trưởng" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Kế toán đơn vị
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.keToan" placeholder="Nhập tên kế toán đơn vị" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Kỹ thuật viên bảo quản
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.kyThuatVien" placeholder="Nhập tên kỹ thuật viên" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Thủ kho
          </nz-form-label>
          <input nz-input placeholder="Nhập tên thủ kho" [(ngModel)]="detail.thuKho" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Theo hợp đồng số
          </nz-form-label>
          <nz-select [(ngModel)]="detail.soHopDong" (ngModelChange)="changeHopDong()"
            [disabled]="isDisableField() || isView">
            <nz-option *ngFor="let item of listHopDong" [nzValue]="item.hopDong.soHd" [nzLabel]="item.hopDong.soHd">
            </nz-option>
          </nz-select>
        </nz-form-item>
      </div>
    </div>
  </nz-card>
  <nz-card nzTitle="" class="mt16 flex-card p-lr16">
    <div class="search__body" nz-row [nzGutter]="[18, 6]">
      <div nz-col [nzSpan]="4">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true"> Loại hàng hóa</nz-form-label>
          <nz-input-group nzAddOnAfterIcon="folder-open" (click)="selectHangHoa()">
            <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenVatTuCha" readonly="true" />
          </nz-input-group>
        </nz-form-item>
      </div>
      <div nz-col [nzSpan]="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true"> Chủng loại hàng hóa</nz-form-label>
          <nz-input-group nzAddOnAfterIcon="folder-open" (click)="selectHangHoa()">
            <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenVatTu" readonly="true" />
          </nz-input-group>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Điểm kho
          </nz-form-label>
          <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenDiemKho" readonly="true" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Nhà kho
          </nz-form-label>
          <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenNhaKho" readonly="true" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Ngăn kho
          </nz-form-label>
          <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenNganKho" readonly="true" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="4">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Lô kho
          </nz-form-label>
          <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenNganLo" readonly="true" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Ngày bắt đầu nhập
          </nz-form-label>
          <nz-date-picker class="search__input" nzFormat="yyyy-MM-dd" nzPlaceHolder="Ngày bắt đầu nhập"
            [(ngModel)]="detail.ngayBatDauNhap" [nzDisabledDate]="disabledStartDate"
            [disabled]="isDisableField() || isView">
          </nz-date-picker>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="5">
        <nz-form-item class="form-item">
          <nz-form-label [nzNoColon]="true">
            Ngày kết thúc nhập
          </nz-form-label>
          <nz-date-picker class="search__input" nzFormat="yyyy-MM-dd" nzPlaceHolder="Ngày kết thúc nhập"
            [(ngModel)]="detail.ngayKetThucNhap" [nzDisabledDate]="disabledEndDate"
            [disabled]="isDisableField() || isView">
          </nz-date-picker>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="24" class="bien-ban-day-kho">
        <nz-table #basicTable class="mt-16 table__body" #bbNhapDayKhoDetail nzBordered
          [nzData]="dsBienBanNhapDayKhoDetailClone" [nzFrontPagination]="false" [nzShowPagination]="false">
          <thead>
            <tr>
              <th rowSpan="2" class="text-center">STT <br> (A)</th>
              <th colspan="3" class="text-center">KẾT QUẢ NHẬP KHO</th>
              <th rowspan="2" class="text-center">GHI CHÚ <br> (A)</th>
              <!-- <th rowspan="2" class="text-center" *ngif="!isView">HÀNH ĐỘNG</th> -->
            </tr>
            <tr>
              <th class="text-center"> SỐ LƯỢNG <br>
                (1)</th>
              <th class="text-center"> ĐƠN GIÁ <br>
                (2)</th>
              <th class="text-center"> THÀNH TIỀN <br>
                (3) = (1)x(2)</th>
            </tr>
          </thead>
          <tbody>
            <tr [ngClass]="isView ? 'row-disabled' : ''">
              <td></td>
              <td>
                <nz-input-number type="text" nz-input name="soLuong" [nzMin]="0" [nzMax]="globals.prop.MAX_INPUT"
                  [nzSize]="'small'" [(ngModel)]="bienBanNhapDayKhoDetailCreate.soLuong">
                </nz-input-number>
              </td>
              <td>
                <nz-input-number type="text" nz-input name="soLuong" [nzMin]="0" [nzMax]="globals.prop.MAX_INPUT"
                  [nzSize]="'small'" [(ngModel)]="bienBanNhapDayKhoDetailCreate.donGia">
                </nz-input-number>
              </td>
              <td>
                {{calculatorThanhTienCreate()}}
              </td>
              <td>
                <input nz-input [(ngModel)]="bienBanNhapDayKhoDetailCreate.ghiChu" />
              </td>
              <!-- <td class="text-center" *ngIf="!isView">
                      <a class="save" (click)="themmoi()"
                        [ngClass]="{'isDisabled': bienBanNhapDayKhoDetailCreate.thanhTien === 0 || !bienBanNhapDayKhoDetailCreate.thanhTien}">
                        <i class="icon htvbdh_dau-cong"></i>
                      </a>
                      <a (click)="clearNew()"
                        [ngClass]="{'isDisabled': bienBanNhapDayKhoDetailCreate.thanhTien === 0 || !bienBanNhapDayKhoDetailCreate.thanhTien}">
                        <i class="fa fa-trash-o do"></i>
                      </a>
                    </td> -->
            </tr>
            <!-- <tr *ngFor="let dataBBNhapDayKho of bbNhapDayKhoDetail.data, let i = index">
                    <ng-container *ngIf="!dsBienBanNhapDayKhoDetailClone[i].isEdit; else editTemplate">
                      <td>{{dataBBNhapDayKho.stt | number: '1.0-1'}}</td>
                      <td>{{dataBBNhapDayKho.soLuong | number: '1.0-1'}}</td>
                      <td>{{dataBBNhapDayKho.donGia | number: '1.0-1'}}</td>
                      <td>{{dataBBNhapDayKho.thanhTien | number: '1.0-1'}}</td>
                      <td>{{dataBBNhapDayKho.ghiChu}}</td>
                      <td class="text-center" *ngIf="!isView">
                        <a (click)="startEdit(i)">
                          <i class="fa fa-pencil"></i>
                        </a>
                        <a (click)="deleteData(dataBBNhapDayKho.stt)">
                          <i class="fa fa-trash-o do"></i>
                        </a>
                      </td>
                    </ng-container>
                    <ng-template #editTemplate>
                      <td>{{dataBBNhapDayKho.stt }}</td>
                      <td>
                        <nz-input-number type="text" nz-input name="goiThau" [nzMin]="0" [nzMax]="" [nzSize]="'small'"
                          [(ngModel)]="dsBienBanNhapDayKhoDetailClone[i].soLuong">
                        </nz-input-number>
                      </td>
                      <td>
                        <nz-input-number type="text" nz-input name="goiThau" [nzMin]="0" [nzMax]="" [nzSize]="'small'"
                          [(ngModel)]="dsBienBanNhapDayKhoDetailClone[i].donGia">
                        </nz-input-number>
                      </td>
                      <td>{{calculatorThanhTienEdit(i)}}</td>
                      <td>
                        <input nz-input [(ngModel)]="dsBienBanNhapDayKhoDetailClone[i].ghiChu" />
                      </td>
                      <td class="text-center" *ngIf="!isView">
                        <a (click)="saveEditBBDayKho(i)">
                          <i class="fa fa-save"></i>
                        </a>
                        <a (click)="cancelEditBBDayKho(i)">
                          <i class="fa fa-times do"></i>
                        </a>
                      </td>
                    </ng-template>
                  </tr> -->
          </tbody>
        </nz-table>
      </div>
    </div>
    <div class="comment-last" nz-row [nzGutter]="[18, 6]">
      <div nz-col nzSpan="24" class="text-summary">File đính kèm khác</div>
      <div nz-col nzSpan="24">
        <file-list></file-list>
      </div>
    </div>
  </nz-card>
</div>