<div class="bg-trang">
  <div class="header header-green-background">
    <div class="header-text">
      <div class="title-chi-tieu">
        <span
          [ngClass]="formData.value.trangThai == STATUS.BAN_HANH ? 'status-xanh' : 'status-do'">
          {{ formData.value.tenTrangThai }}
        </span>
        <span>Báo cáo nguồn hình thành dự trữ quốc gia</span>
      </div>
    </div>
    <div class="btn-group">
      <button type="button" class="btn btn-sub" (click)="quayLai()">
        <i class="fa fa-arrow-left"></i>
        <span>Quay lại</span>
      </button>
      <ng-container>
        <button *ngIf="formData.value.trangThai == STATUS.DU_THAO && !isView"
                type="button" class="btn btn-sub xanh-nhat" (click)="guiDuyet(idInput)">
          <i class="icon htvbdh_tcdt_pheduyet"></i>
          <span>Ban hành</span>
        </button>
        <button *ngIf="formData.value.trangThai == STATUS.DU_THAO && !isView"
                type="button" class="btn btn-main" (click)="save()">
          <i class="icon htvbdh_tcdt_save"></i>
          <span>Lưu</span>
        </button>
      </ng-container>
    </div>
  </div>
  <nz-card class="mg-t-16 flex-card p-lr16">
    <div class="header header-green-background mg-t-16">
      <div class="header-text">
        <div class="title-chi-tieu">
          <span></span>
          <span>Thông tin chung</span>
        </div>
      </div>
    </div>
    <form nzLayout="vertical" nz-form [formGroup]="formData">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Thông tư số</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input readonly formControlName="thongTuSo" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Biểu số</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input readonly formControlName="bieuSo" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Đơn vị gửi báo cáo</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input readonly formControlName="tenDonViGui" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="6">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Đơn vị nhận báo cáo</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input readonly formControlName="tenDonViNhan" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Thời gian tạo</nz-form-label>
            <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="error">
              <nz-date-picker nzDisabled formControlName="ngayTao" nzFormat="dd/MM/yyyy">
              </nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" class="label-color-kh"> Năm báo cáo
            </nz-form-label>
            <nz-select formControlName="namBc" [nzDisabled]="isView">
              <nz-option *ngFor="let p of listNam" [nzValue]="p.value" [nzLabel]="p.text"></nz-option>
            </nz-select>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" class="label-color-kh"> Kỳ báo cáo
            </nz-form-label>
            <nz-select formControlName="kyBc" [nzDisabled]="isView">
              <nz-option *ngFor="let p of listQuy" [nzValue]="p.value" [nzLabel]="p.text"></nz-option>
            </nz-select>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" class="label-color-kh"> Loại báo cáo
            </nz-form-label>
            <nz-select formControlName="loaiBc" (ngModelChange)="changeLoaiBc($event)" [nzDisabled]="isView">
              <nz-option *ngFor="let p of listLoaiBc" [nzValue]="p.value" [nzLabel]="p.text"></nz-option>
            </nz-select>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"> Thời hạn gửi báo cáo</nz-form-label>
            <nz-form-control>
              <nz-input-group>
                <input nz-input readonly formControlName="thoiHanGuiBc" />
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </form>
  </nz-card>
  <div class="group-button">
    <h3>DANH SÁCH BÁO CÁO NGUỒN HÌNH THÀNH DỰ TRỮ QUỐC GIA</h3>
    <div class="buttons">
      <button type="button" class="btn btn-main" (click)="themMoiDanhMuc()">
        <i class="icon htvbdh_dau-cong"></i>
        <span>Thêm</span>
      </button>
    </div>
  </div>
  <nz-card class="mt-2px flex-card data-table card-border-content table-card">
    <nz-table class="nowrap" [nzData]="dataTable" [nzFrontPagination]="false"
              [nzShowPagination]="false" nzBordered [nzScroll]="{ x: '1700px' }">
      <thead>
      <tr>
        <th rowSpan="3" class="text-center multi-line" nzWidth="60px" nzLeft>STT</th>
        <th rowSpan="3" class="text-center multi-line" nzWidth="200px" nzLeft>Danh mục/Đơn vị
          bảo quản từng mặt hàng
        </th>
        <th rowSpan="3" class="text-center multi-line" nzWidth="100px" nzLeft>Mặt hàng</th>
        <th rowSpan="3" class="text-center multi-line" nzWidth="60px">Mã số</th>
        <th rowSpan="3" class="text-center multi-line" nzWidth="60px">ĐVT</th>
        <th colSpan="2" class="text-center multi-line" nzWidth="80px">Tồn kho đầu năm</th>
        <th colSpan="2" class="text-center multi-line" nzWidth="80px">Tồn kho đầu kỳ</th>
        <th colSpan="4" class="text-center multi-line" nzWidth="80px">Nhập</th>
        <th colSpan="4" class="text-center multi-line" nzWidth="80px">Xuất</th>
        <th colSpan="2" class="text-center multi-line" nzWidth="80px">Tồn kho cuối quý</th>
        <th colSpan="3" class="text-center multi-line" nzWidth="80px">Tỷ lệ (%) tổng dự mức DTQG tồn kho cuối kỳ so
          với
        </th>
        <th rowSpan="3" class="text-center multi-line" nzWidth="80px" nzRight>Hành động</th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
        <th nzWidth="80px" style="display: none"></th>
      </tr>
      <tr>
        <th rowSpan="2" class="text-center multi-line">Số lượng</th>
        <th rowSpan="2" class="text-center multi-line">Giá trị (tỷ đồng)</th>
        <th rowSpan="2" class="text-center multi-line">Số lượng</th>
        <th rowSpan="2" class="text-center multi-line">Giá trị (tỷ đồng)</th>
        <th colSpan="2" class="text-center multi-line">Nhập trong kỳ</th>
        <th colSpan="2" class="text-center multi-line">Lũy kế từ đầu năm</th>
        <th colSpan="2" class="text-center multi-line">Xuất trong kỳ</th>
        <th colSpan="2" class="text-center multi-line">Lũy kế từ đầu năm</th>
        <th rowSpan="2" class="text-center multi-line">Số lượng</th>
        <th rowSpan="2" class="text-center multi-line">Giá trị (tỷ đồng)</th>
        <th rowSpan="2" class="text-center multi-line">Chiến lược</th>
        <th rowSpan="2" class="text-center multi-line">Kế hoạch 5 năm</th>
        <th rowSpan="2" class="text-center multi-line">GDP cùng kỳ</th>
      </tr>
      <tr>
        <th class="text-center multi-line">Số lượng</th>
        <th class="text-center multi-line">Giá trị (tỷ đồng)</th>
        <th class="text-center multi-line">Số lượng</th>
        <th class="text-center multi-line">Giá trị (tỷ đồng)</th>
        <th class="text-center multi-line">Số lượng</th>
        <th class="text-center multi-line">Giá trị (tỷ đồng)</th>
        <th class="text-center multi-line">Số lượng</th>
        <th class="text-center multi-line">Giá trị (tỷ đồng)</th>
      </tr>
      <tr class="grey-bg">
        <th nzLeft></th>
        <th class="text-center" nzLeft>A</th>
        <th class="text-center" nzLeft>B</th>
        <th class="text-center">C</th>
        <th class="text-center">1</th>
        <th class="text-center">2</th>
        <th class="text-center">3</th>
        <th class="text-center">4</th>
        <th class="text-center">5</th>
        <th class="text-center">6</th>
        <th class="text-center">7</th>
        <th class="text-center">8</th>
        <th class="text-center">9</th>
        <th class="text-center">10</th>
        <th class="text-center">11</th>
        <th class="text-center">12</th>
        <th class="text-center">13</th>
        <th class="text-center">14</th>
        <th class="text-center">15</th>
        <th class="text-center">16</th>
        <th class="text-center">17</th>
        <th class="text-center">18</th>
        <th class="text-center" nzRight></th>
      </tr>
      </thead>
      <tbody>
      <ng-container *ngFor="let data of listDataGroup; let i = index">
        <tr>
          <td nzLeft class="text-center">{{(page - 1) * pageSize + i + 1}}</td>
          <td nzLeft>{{ data.danhMuc }}</td>
          <td nzLeft></td>
          <td>{{ data.maSo }}</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td nzRight>
            <a *ngIf="!isView">
              <i class=" fa fa-pencil"></i>
            </a>
            <a *ngIf="!isView">
              <i class=" fa fa-trash-o do"></i>
            </a>
          </td>
        </tr>
        <ng-container *ngFor="let nhomMatHang of data.listNhomMatHang, let y = index">
          <tr>
            <td nzLeft class="text-center">{{(page - 1) * pageSize + y + 1}}</td>
            <td nzLeft>{{ nhomMatHang.danhMuc }}</td>
            <td nzLeft></td>
            <td>{{ nhomMatHang.maSo }}</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td nzRight>
              <a *ngIf="!isView">
                <i class=" fa fa-pencil"></i>
              </a>
              <a *ngIf="!isView">
                <i class=" fa fa-trash-o do"></i>
              </a>
            </td>
          </tr>
          <ng-container *ngFor="let matHang of nhomMatHang.listMatHang, let y = index">
            <tr>
              <td nzLeft class="text-center">{{(page - 1) * pageSize + i + 1}}</td>
              <td nzLeft></td>
              <td nzLeft>{{ matHang.matHang }}</td>
              <td>{{ matHang.maSo }}</td>
              <td>{{ matHang.dvt }}</td>
              <td>{{ matHang.slTonDauNam }}</td>
              <td>{{ matHang.gtriTonDauNam }}</td>
              <td>{{ matHang.slTonDauKy }}</td>
              <td>{{ matHang.gtriTonDauKy }}</td>
              <td>{{ matHang.slNhapTrongKy }}</td>
              <td>{{ matHang.gtriNhapTrongKy }}</td>
              <td>{{ matHang.slNhapLuyKe }}</td>
              <td>{{ matHang.gtriNhapLuyKe }}</td>
              <td>{{ matHang.slXuatTrongKy }}</td>
              <td>{{ matHang.gtriXuatTrongKy }}</td>
              <td>{{ matHang.slXuatLuyKe }}</td>
              <td>{{ matHang.gtriXuatLuyKe }}</td>
              <td>{{ matHang.slTonCuoiQuy }}</td>
              <td>{{ matHang.gtriTonCuoiQuy }}</td>
              <td>{{ matHang.tiLeChienLuoc }}</td>
              <td>{{ matHang.tiLeKeHoach }}</td>
              <td>{{ matHang.tiLeGdp }}</td>
              <td nzRight>
                <a *ngIf="!isView">
                  <i class=" fa fa-pencil"></i>
                </a>
                <a *ngIf="!isView">
                  <i class=" fa fa-trash-o do"></i>
                </a>
              </td>
            </tr>
          </ng-container>
        </ng-container>
      </ng-container>
      <!--      <ng-template #editTemplate>-->
      <!--        <td><input nz-input [(ngModel)]="itemRowNguonEdit[i].noiDung" /></td>-->
      <!--        <td><input nz-input [(ngModel)]="itemRowNguonEdit[i].maSo" /></td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].muaTangTrongKy"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].muaBuTrongKy"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].muaBsungTrongKy"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].khacTrongKy"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td></td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].muaTangLuyKe"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].muaBuLuyKe"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].muaBsungLuyKe"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].khacLuyKe"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td></td>-->
      <!--        <td>-->
      <!--          <nz-input-number [nzMin]="0" [nzFormatter]="globals.formatter" [nzParser]="globals.parser"-->
      <!--                           [(ngModel)]="itemRowNguonEdit[i].tiLe"></nz-input-number>-->
      <!--        </td>-->
      <!--        <td>-->
      <!--          <a (click)="saveEditRowNguon(i)">-->
      <!--            <i class="icon htvbdh_tcdt_save"></i>-->
      <!--          </a>-->
      <!--          <a (click)="cancelEditRowNguon(i)">-->
      <!--            <i class="fa fa-ban do"></i>-->
      <!--          </a>-->
      <!--        </td>-->
      <!--      </ng-template>-->
      <tr>
        <td nzLeft></td>
        <td nzLeft></td>
        <td nzLeft class="first-last-row-table background-last-row text-right">Tổng</td>
        <td class="text-center">X</td>
        <td class="text-center">X</td>
        <td class="text-center">X</td>
        <td class="text-center"></td>
        <td class="text-center">X</td>
        <td class="text-center"></td>
        <td class="text-center">X</td>
        <td class="text-center"></td>
        <td class="text-center">X</td>
        <td class="text-center"></td>
        <td class="text-center">X</td>
        <td class="text-center"></td>
        <td class="text-center">X</td>
        <td class="text-center"></td>
        <td class="text-center">X</td>
        <td class="text-center"></td>
        <td class="text-center"></td>
        <td class="text-center"></td>
        <td class="text-center"></td>
        <td nzRight class="text-center"></td>
      </tr>
      </tbody>
    </nz-table>
    <label><span style="color: red">* </span> Ghi chú</label>
    <textarea rows="3" readonly nz-input [(ngModel)]="ghiChu"></textarea>
  </nz-card>
</div>
<ng-template #error let-control>
  <ng-container *ngIf="control.hasError('required')">{{globals.prop.REQUIRED}}</ng-container>
</ng-template>