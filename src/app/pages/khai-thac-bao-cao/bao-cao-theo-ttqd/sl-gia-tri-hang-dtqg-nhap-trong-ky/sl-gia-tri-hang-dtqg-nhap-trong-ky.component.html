<div class="luong-thuc__danh-sach">
  <div class="bg-trang">
    <h3 class="text-uppercase">Số lượng và giá trị hàng DTQG nhập trong kỳ</h3>
    <nz-card class="mt16 flex-card p-lr16">
      <form nzLayout="vertical" nz-form [formGroup]="formData">
        <ng-template #error let-control>
          <app-template-error #error [control]="control"></app-template-error>
        </ng-template>
        <div nz-row [nzGutter]="24">
          <div nz-col [nzSpan]="3">
            <nz-form-item>
              <nz-form-label [nzNoColon]="true" class="label-color-kh"> Năm
              </nz-form-label>
              <nz-select formControlName="nam">
                <nz-option *ngFor="let p of listNam" [nzValue]="p.value" [nzLabel]="p.text"></nz-option>
              </nz-select>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="4">
            <nz-form-item>
              <nz-form-label [nzNoColon]="true" class="label-color-kh"> Loại báo cáo
              </nz-form-label>
              <nz-select formControlName="loaiBc">
                <nz-option *ngFor="let p of dsLoaiBc" [nzValue]="p.value" [nzLabel]="p.text"></nz-option>
              </nz-select>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="6">
            <nz-form-item>
              <nz-form-label [nzNoColon]="true" class="label-color-kh"> Cục DTNN KV
              </nz-form-label>
              <nz-select formControlName="dviBaoCao">
                <nz-option *ngFor="let p of dsDonVi" [nzValue]="p.maDvi" [nzLabel]="p.tenDvi"></nz-option>
              </nz-select>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="6">
            <nz-form-item>
              <nz-form-label [nzNoColon]="true" class="label-color-kh"> Chi cục DTNN
              </nz-form-label>
              <nz-select formControlName="dviNhanBaoCao">
                <nz-option *ngFor="let p of dsDonVi" [nzValue]="p.maDvi" [nzLabel]="p.tenDvi"></nz-option>
              </nz-select>
            </nz-form-item>
          </div>
        </div>
      </form>
    </nz-card>
    <div class="group-button">
      <button type="button" class="btn btn-sub" (click)="preView()"
              *ngIf="!userService.isAccessPermisson('XHDTQG_XCTVT_XDPA_EXP1')">
        <i class="icon htvbdh_chuyen-xu-ly"></i>
        <span>Kết xuất báo cáo</span>
      </button>
    </div>
  </div>
</div>

<!--popup preview-->
<nz-modal [(nzVisible)]="showDlgPreview" nzTitle="Báo cáo" nzWidth="100%">
  <div *nzModalContent class="modal__content">
    <pdf-viewer [src]="pdfSrc" [original-size]="false" [render-text]="true" style="width: 100%; height: 600px;">
    </pdf-viewer>
  </div>
  <div *nzModalFooter>
    <button nz-button (click)="downloadPdf()"
            class="modal__button--save">
      <i class="icon htvbdh_tcdt_tuchoi"></i>
      Tải báo cáo
    </button>
    <button nz-button (click)="downloadExcel()" class="modal__button--save">
      <i class="icon htvbdh_tcdt_tuchoi"></i>
      Tải báo cáo Excel
    </button>
    <button nz-button (click)="closeDlg()" class="modal__button--cancel">
      <i nz-icon nzType="close-circle" nzTheme="fill" class="icon-cancel"></i>
      Đóng
    </button>
  </div>
</nz-modal>
