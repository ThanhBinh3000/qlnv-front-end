<nz-affix class="btn-affix" [nzOffsetTop]="globals.prop.MENU_LV2" *ngIf="!isTaoQd">
  <div class="btn-group">
    <button type="button" class="btn btn-sub" (click)="quayLai()">
      <i class="fa fa-arrow-left"></i>
      <span>Quay lại</span>
    </button>
    <!--    <button-->
    <!--      *ngIf="detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_TONG_CUC && detail.trangThai != globals.prop.NHAP_DA_DUYET_LD_TONG_CUC"-->
    <!--      type="button" class="btn btn-sub" (click)="tuChoi()">-->
    <!--      <i class="icon htvbdh_tcdt_tuchoi do"></i>-->
    <!--      <span>Từ chối</span>-->
    <!--    </button>-->
    <!--    <button *ngIf="detail.trangThai == globals.prop.NHAP_DU_THAO" type="button" class="btn btn-sub"-->
    <!--      (click)="guiDuyet()">-->
    <!--      <i class="icon htvbdh_tcdt_guiduyet"></i>-->
    <!--      <span>Lưu và gửi duyệt</span>-->
    <!--    </button>-->
    <!--    <button class="btn btn-sub" *ngIf="detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_TONG_CUC"-->
    <!--      (click)="pheDuyet()">-->
    <!--      <i class="icon htvbdh_tcdt_pheduyet"></i>-->
    <!--      <span>Duyệt</span>-->
    <!--    </button>-->
    <button *ngIf="isTongHop && (idInput == 0 || detail.trangThai === globals.prop.NHAP_CHUA_TAO_QD)" type="button"
      class="btn btn-sub" (click)="save(true)">
      <i class="icon htvbdh_tcdt_guiduyet"></i>
      <span>Lưu và tạo quyết định</span>
    </button>
    <button
      *ngIf="isTongHop && (detail.trangThai === globals.prop.NHAP_DU_THAO || detail.trangThai === globals.prop.NHAP_CHUA_TAO_QD )"
      type="button" class="btn btn-main" (click)="save()">
      <i class="icon htvbdh_tcdt_save"></i>
      <span>Lưu</span>
    </button>
  </div>
</nz-affix>
<div class="bg-trang" *ngIf="!isTaoQd">
  <nz-card class="mt16 flex-card p-lr16">
    <form nzLayout="vertical" nz-form [formGroup]="formData">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="3">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Năm kế hoạch</nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="namKeHoach" [nzDisabled]="isDisableField() || isView">
                <nz-option *ngFor="let p of listNam" [nzValue]="p.value" [nzLabel]="p.text"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="5">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Loại hàng hoá </nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="loaiVthh" [nzDisabled]="isDisableField() || isView"
                (ngModelChange)="changeLoaiHangHoa()">
                <nz-option *ngFor="let p of listLoaiHangHoa" [nzValue]="p.ma" [nzLabel]="p.ten"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="5">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true">Chủng Loại hàng hoá </nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-select formControlName="cloaiVthh" [nzDisabled]="isDisableField() || isView">
                <nz-option *ngFor="let p of listChungLoaiHangHoa" [nzValue]="p.ma" [nzLabel]="p.ten"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="5">
          <nz-form-item>
            <nz-form-label nzRequired [nzNoColon]="true"> Ngày ký đề xuất KH bán đấu giá </nz-form-label>
            <nz-form-control [nzErrorTip]="error">
              <nz-range-picker class="search__input" [nzDisabled]="isDisableField() || isView"
                formControlName="ngayKyDeXuat" nzFormat="dd/MM/yyyy">
              </nz-range-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="24">
          <div class="tong-hop-button group-button-search">
            <button class="btn btn-main btn-sm waves-effect waves-light" (click)="tongHopDeXuatTuCuc()"
              *ngIf="detail.trangThai == globals.prop.NHAP_DU_THAO && idInput == 0 && !isTongHop">
              <i class="icon htvbdh_tcdt_tong-hop-de-xuat-tu-cuc"></i>
              <span>Tổng hợp KH bán đấu giá</span>
            </button>
          </div>
        </div>
      </div>
      <ng-template #error let-control>
        <app-template-error #error [control]="control"></app-template-error>
      </ng-template>
    </form>
  </nz-card>
  <div *ngIf="isTongHop">
    <div class="header">
      <div class="header-text">
        <div class="title-chi-tieu">
          <span></span>
          <span>thông tin chung</span>
        </div>
      </div>
    </div>
    <nz-card class="mt16 flex-card p-lr16">
      <form nzLayout="vertical" nz-form [formGroup]="formData">
        <div nz-row [nzGutter]="24">
          <div nz-col [nzSpan]="8">
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true"> Ngày tổng hợp </nz-form-label>
              <nz-form-control [nzErrorTip]="error">
                <nz-date-picker class="search__input" [nzDisabled]="isDisableField() || isView"
                  formControlName="ngayTongHop" nzFormat="dd/MM/yyyy">
                </nz-date-picker>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="16">
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true"> Nội dung tổng hợp </nz-form-label>
              <nz-form-control [nzErrorTip]="error">
                <nz-input-group>
                  <input nz-input formControlName="noiDungTongHop" [readonly]="isDisableField() || isView" />
                </nz-input-group>
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>
        <div nz-row [nzGutter]="24">
          <div nz-col [nzSpan]="8">
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true"> Thời gian dự kiến tổ chức bán đấu giá
              </nz-form-label>
              <nz-form-control [nzErrorTip]="error">
                <nz-range-picker class="search__input" [nzDisabled]="isDisableField() || isView"
                  formControlName="tgDuKienTcbdg" nzFormat="dd/MM/yyyy">
                </nz-range-picker>
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>
        <ng-template #error let-control>
          <app-template-error #error [control]="control"></app-template-error>
        </ng-template>
      </form>
    </nz-card>
    <div class="header">
      <div class="header-text">
        <div class="title-chi-tieu">
          <span></span>
          <span>Thông tin chi tiết đề xuất của các cục DTNN KV</span>
        </div>
      </div>
    </div>
    <nz-card class="mt-2px flex-card data-table card-border-content table-card">
      <nz-table #expandTable [nzData]="listOfData" nzTableLayout="fixed">
        <thead>
          <tr>
            <th width="5%">STT</th>
            <th width="15%">Cục DTNN KV</th>
            <th width="15%">Số kế hoạch</th>
            <th width="10%">Ngày ký</th>
            <th width="25%">Trích yếu</th>
            <th width="10%">Số lượng đơn vị tài sản</th>
            <th width="10%">Giá khởi điểm (đồng)</th>
            <th width="10%">Khoản tiền đặt trước (đồng)</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of expandTable.data;let i = index">
            <td class="text-center">{{ i + 1 }}</td>
            <td>{{ data.tenDonVi }}</td>
            <td>{{ data.soKeHoach }}</td>
            <td>{{ data.ngayKy }}</td>
            <td>{{ data.trichYeu }}</td>
            <td>{{ data.soLuong | number : '1.0-1' : 'vi_VN' }}</td>
            <td>{{ data.giaKhoiDiem | number : '1.0-1' : 'vi_VN' }}</td>
            <td>{{ data.khoanTienDatTruoc | number : '1.0-1' : 'vi_VN' }}</td>
          </tr>
        </tbody>
      </nz-table>
    </nz-card>
    <form nzLayout="vertical" nz-form [formGroup]="formData" class="mt-16 mb-16">
      <nz-form-item>
        <nz-form-label [nzNoColon]="true">
          Ghi chú
        </nz-form-label>
        <nz-form-control nz-col [nzSpan]="24">
          <textarea rows="3" class="search__input" nz-input formControlName="ghiChu"
            [readonly]="isDisableField() || isView" [ngClass]="isDisableField() || isView ? 'disable' : ''"></textarea>
        </nz-form-control>
      </nz-form-item>
    </form>
  </div>

</div>
<div class="tao-quyet-dinh" *ngIf="isTaoQd">
  <ng-container>
    <app-them-moi-qd-phe-duyet-kh-ban-dau-gia [loaiVthh]="loaiVthhInput" [idInput]="0" [dataTongHop]="formData.value">
    </app-them-moi-qd-phe-duyet-kh-ban-dau-gia>
  </ng-container>
</div>