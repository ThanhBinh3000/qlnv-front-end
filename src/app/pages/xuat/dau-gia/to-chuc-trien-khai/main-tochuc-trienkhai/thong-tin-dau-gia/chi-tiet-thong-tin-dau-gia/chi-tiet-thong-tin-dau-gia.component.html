<nz-affix [nzOffsetTop]="globals.prop.MENU_LV2" class="btn-affix">
  <div class="btn-group">
    <button type="button" class="btn btn-sub" (click)="goBack()">
      <i class="fa fa-arrow-left"></i>
      <span>Quay lại</span>
    </button>
    <button *ngIf="this.userService.isCuc() && formData.value.trangThai != STATUS.HOAN_THANH_CAP_NHAT" type="button"
      class="btn btn-sub xanh-nhat" (click)="hoanThanhCapNhat()">
      <i class="icon htvbdh_tcdt_guiduyet"></i>
      <span>Kết thúc đấu giá</span>
    </button>
  </div>
</nz-affix>
<div class="bg-trang">
  <div class="header header-green-background">
    <div class="header-text">
      <div class="title-chi-tieu">
        <span [ngClass]="formData.value.trangThai == STATUS.HOAN_THANH_CAP_NHAT ? 'status-xanh' : 'status-do'">
          {{ formData.value.tenTrangThai }}
        </span>
        <span>Quản lý thông tin đấu giá</span>
      </div>
    </div>
  </div>
  <nz-card class="flex-card p-lr16">
    <!-- START THÔNG TIN CHUNG -->
    <nz-collapse>
      <nz-collapse-panel nzActive="true" nzHeader="THÔNG TIN CHUNG">
        <form nzLayout="horizontal" [formGroup]="formData" nz-form>
          <div nz-row [nzGutter]="24">
            <div nz-col [nzSpan]="8">
              <div nz-row [nzGutter]="24" class="label-50 mg-t-10 border-right">
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Năm kế hoạch </nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="nam" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Số QĐ phê duyệt KH BĐG </nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="soQdPd" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Số QĐ phê duyệt KQ BĐG </nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="soQdPdKqBdg" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Đơn vị thực hiện (đơn vị tài sản ĐG) </nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="tenDvi" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Tổng tiền giá khởi điểm</nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="tongTienGiaKhoiDiem" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Tổng khoản tiền đặt trước</nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="tongTienDatTruoc" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> % khoản tiền đặt trước
                    </nz-form-label>
                    <nz-form-control>
                      <nz-input-number [nzSize]="'small'" formControlName="phanTramDatTruoc"
                        [nzFormatter]="globals.formatter" [nzParser]="globals.parser" nzDisabled>
                      </nz-input-number>
                    </nz-form-control>
                  </nz-form-item>
                </div>
              </div>
            </div>
            <div nz-col [nzSpan]="8">
              <div nz-row [nzGutter]="24" class="label-50 mg-t-10 border-right">
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Thời gian dự kiến tổ chức bán đấu giá</nz-form-label>
                    <nz-form-control>
                      <!--                      thoiGianToChucTu-->
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Thời hạn
                      thanh toán
                    </nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="thoiHanThanhToan" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Phương thức thanh toán </nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="phuongThucThanhToan" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Thời hạn giao nhận hàng
                    </nz-form-label>
                    <nz-form-control>
                      <input nz-input formControlName="thoiHanGiaoNhan" readonly />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Phương thức giao nhận</nz-form-label>
                    <nz-form-control>
                      <!--                      phuongThucGiaoNhan-->
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Tổng khoản tiền đặt trước theo đơn giá duyệt</nz-form-label>
                    <nz-form-control>
                      <!-- <nz-input-group>
                         <nz-date-picker [nzShowTime]="{ nzFormat: 'HH:mm' }"
                                         formControlName="tgianDthau" nzFormat="HH:mm dd/MM/yyyy" nzDisabled>
                         </nz-date-picker>
                       </nz-input-group>-->
                      <!--                      tongTienDatTruocDuocDuyet-->
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Loại hàng hóa</nz-form-label>
                    <nz-form-control>
                      <input style="color: blue ;font-weight: bold;" nz-input formControlName="tenLoaiVthh"
                        readonly="true" />
                    </nz-form-control>
                  </nz-form-item>
                </div>
              </div>
            </div>
            <div nz-col [nzSpan]="8">
              <div nz-row [nzGutter]="24" class="label-50 mg-t-10 ">
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Chủng loại hàng hóa</nz-form-label>
                    <nz-form-control>
                      <input style="color: blue ;font-weight: bold;" nz-input formControlName="tenCloaiVthh"
                        readonly="true" />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Tổng số lượng xuất bán </nz-form-label>
                    <nz-form-control>
                      <nz-input-group>
                        <nz-input-number [nzSize]="'small'" formControlName="tongSoLuong"
                          [nzFormatter]="globals.formatter" [nzParser]="globals.parser" nzDisabled>
                        </nz-input-number>
                      </nz-input-group>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Tổng số đơn vị tài sản đấu giá </nz-form-label>
                    <nz-form-control>
                      <nz-input-group>
                        <input nz-input formControlName="soDviTsan" readonly />
                      </nz-input-group>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Số ĐV tài sản đấu giá thành công </nz-form-label>
                    <nz-form-control>
                      <nz-input-group>
                        <input nz-input formControlName="soDviTsanThanhCong" readonly />
                      </nz-input-group>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Số ĐV tài sản đấu giá không thành </nz-form-label>
                    <nz-form-control>
                      <nz-input-group>
                        <input nz-input formControlName="soDviTsanKhongThanh" readonly />
                      </nz-input-group>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Loại hình nhập xuất</nz-form-label>
                    <nz-form-control>
                      <nz-input-group>
                        <input nz-input formControlName="soDviTsanKhongThanh" readonly />
                      </nz-input-group>
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="24">
                  <nz-form-item>
                    <nz-form-label [nzNoColon]="true"> Kiểu nhập xuất </nz-form-label>
                    <nz-form-control>
                      <nz-input-group>
                        <input nz-input formControlName="soDviTsanKhongThanh" readonly />
                      </nz-input-group>
                    </nz-form-control>
                  </nz-form-item>
                </div>
              </div>
            </div>
          </div>
        </form>
      </nz-collapse-panel>
    </nz-collapse>
    <!-- Thông tin các lần thực hiện đấu giá -->
    <nz-collapse>
      <nz-collapse-panel nzActive="true" [nzExtra]="tmpThemMoiPhienDauGia"
        nzHeader="THÔNG TIN CÁC LẦN THỰC HIỆN ĐẤU GIÁ">
        <ng-template #tmpThemMoiPhienDauGia>
          <div class="buttons"
            *ngIf="this.userService.isCuc() && formData.value.trangThai != STATUS.HOAN_THANH_CAP_NHAT">
            <button style="background: #353a64;" type="button" class="btn btn-main"
              (click)="themMoiPhienDauGia($event)">
              <i class="icon htvbdh_dau-cong"></i>
              <span>Thêm</span>
            </button>
          </div>
        </ng-template>
        <nz-table class="pd-10" nzBordered [nzData]="dataTable" [nzFrontPagination]="false" [nzShowPagination]="false">
          <thead>
            <tr>
              <th width="">Số QĐ PD KH BĐG/Số QĐ ĐC KH BĐG</th>
              <th width="">Lần đấu giá</th>
              <th width="">Thông báo bán đấu giá</th>
              <th width="">Tổ chức thực hiện dịch vụ BĐG</th>
              <th width="">Thời gian tổ chức cuộc đấu giá</th>
              <th width="">Địa điểm tổ chức</th>
              <th width="">Kết quả đấu giá</th>
              <th width="">SL đơn vị TS</th>
              <th width="">Hành động</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of dataTable; let i = index" (click)="selectRow($event,i)">
              <td>{{ data.soQdPd }}</td>
              <td>{{ data.lanDauGia }}</td>
              <td>{{ data.maThongBao }}</td>
              <td>{{ data.tenToChuc }}</td>
              <td>{{ data.tgianDauGiaTu | date: 'dd/MM/YYYY' }}
                đến {{ data.tgianDauGiaDen | date: 'dd/MM/YYYY' }}</td>
              <td>{{ data.diaDiemDauGia }}</td>
              <td>{{ data.ketQua == 1 ? 'Đấu giá thành công' : 'Đấu giá không thành' }}</td>
              <td>{{ data.ketQuaSl }}</td>
              <td class="text-center">
                <a *ngIf="data.trangThai == STATUS.DU_THAO" (click)="themMoiPhienDauGia($event,data)">
                  <i class="fa fa-pencil"></i>
                </a>
                <a *ngIf="data.trangThai == STATUS.DU_THAO" (click)="delete(data)">
                  <i class="fa fa-trash do"></i>
                </a>
              </td>
            </tr>
          </tbody>
        </nz-table>
      </nz-collapse-panel>
    </nz-collapse>
    <!-- <app-thongtin-daugia [data]="dataDetail" [isView]="true"></app-thongtin-daugia> -->
  </nz-card>
</div>
<ng-template #error let-control>
  <app-template-error #error [control]="control"></app-template-error>
</ng-template>