<nz-affix class="btn-affix" [nzOffsetTop]="globals.prop.MENU_LV2">
  <div class="btn-group">
    <button class="btn btn-sub" (click)="print()">
      <i class="icon htvbdh_tcdt_print"></i>
      <span>In</span>
    </button>
    <button class="btn btn-sub"
      *ngIf="(detail.trangThai == globals.prop.NHAP_DU_THAO || detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_CUC || id == 0) && !isView"
      (click)="guiDuyet()">
      <i class="icon htvbdh_trinh"></i>
      <span>Lưu và gửi duyệt</span>
    </button>
    <button class="btn btn-sub" *ngIf="detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_CUC && !isView"
      (click)="hoanThanh()">
      <i class="icon  htvbdh_da-xu-ly"></i>
      <span>Hoàn thành phiếu</span>
    </button>
    <button class="btn btn-sub" *ngIf="detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC && !isView"
      (click)="pheDuyet()">
      <i class="icon htvbdh_dakyduyet"></i>
      <span>Duyệt</span>
    </button>
    <button class="btn btn-sub" (click)="tuChoi()"
      *ngIf="detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC && !isView">
      <i class="icon htvbdh_tcdt_tuchoi"></i>
      <span>Từ chối</span>
    </button>
    <button class="btn btn-sub xanh" (click)="save(false)"
      *ngIf="(detail.trangThai == globals.prop.NHAP_DU_THAO || detail.trangThai == globals.prop.NHAP_CHO_DUYET_LD_CUC || id == 0) && !isView">
      <i class="icon  htvbdh_tcdt_save"></i>
      <span>Lưu</span>
    </button>
    <button class="btn btn-sub" (click)="back()">
      <span>Quay về</span>
    </button>
  </div>
</nz-affix>
<div class="bg-trang">
  <div class="header">
    <div class="header-text">
      <div class="title-chi-tieu">
        <span [ngClass]="thongTinTrangThai(detail.trangThai)">{{detail.tenTrangThai ?
          detail.tenTrangThai :
          'BẢN THẢO'}}</span>
        <span class="title-form">Tạo hồ sơ kỹ thuật nhập vật tư</span>
      </div>
    </div>
  </div>

  <nz-card nzTitle="" class="mt-16 flex-card p-lr16">
    <div class="search__body" nz-row [nzGutter]="[18, 6]">
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số quyết định nhập
          </nz-form-label>
          <nz-select [(ngModel)]="detail.qdgnvnxId" (ngModelChange)=" changeSoQuyetDinh()"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView">
            <nz-option *ngFor="let item of listSoQuyetDinh" [nzValue]="item.id" [nzLabel]="item.soQd">
            </nz-option>
          </nz-select>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số biên bản bàn giao mẫu
          </nz-form-label>
          <nz-select [(ngModel)]="detail.bienBanGiaoMauId" (ngModelChange)="changeBanGiaoMau()"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView">
            <nz-option *ngFor="let item of listBanGiaoMau" [nzValue]="item.id" [nzLabel]="item.soBienBan">
            </nz-option>
          </nz-select>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8"></div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Đơn vị
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.tenDvi" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Mã QHNS
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.maDvi" disabled />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số biên bản
          </nz-form-label>
          <input nz-input placeholder="Nhập số biên bản" [(ngModel)]="detail.soBienBan"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Loại hàng
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.loaiVthh"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số hợp đồng
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.soHopDong"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Ngày hợp đồng
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.ngayHopDong"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Đơn vị cung cấp hàng
          </nz-form-label>
          <input nz-input [(ngModel)]="detail.donViCungCap"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Ngày kiểm tra
          </nz-form-label>
          <nz-date-picker class="search__input" [nzDisabledDate]="" nzFormat="yyyy-MM-dd"
            [(ngModel)]="detail.ngayKiemTra"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView">
          </nz-date-picker>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Địa điểm kiểm tra
          </nz-form-label>
          <input placeholder="Nhập địa điểm lấy mẫu" nz-input [(ngModel)]="detail.diaDiemKiemTra"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
        </nz-form-item>
      </div>
    </div>
  </nz-card>
  <nz-card nzTitle="" class="mt-16 flex-card p-lr16 phieu-kiem-nghiem">
    <div class="search__body" nz-row [nzGutter]="[18, 6]">
      <div nz-col nzSpan="24">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true" class="title-form-chi-tiet">
            1. Thành phần kiểm tra
          </nz-form-label>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item class="d-flex flex-column">
          <nz-form-label [nzNoColon]="true" class="d-flex">
            Đại diện cục dự trữ nhà nước
          </nz-form-label>
          <div class="pd-b-16 d-flex" *ngFor="let item of listDaiDienCuc;let i = index">
            <input nz-input [(ngModel)]="item.daiDien"
              [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
            <div class="btn-plus"
              *ngIf="i == 0 && !(detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView)"
              (click)="addDaiDien(capCuc)">
              <i class="icon htvbdh_dau-cong"></i>
            </div>
            <div class="btn-plus"
              *ngIf="i != 0 && !(detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView)"
              (click)="xoaDaiDien(item)">
              <i class="fa fa-trash-o do"></i>
            </div>
          </div>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item class="d-flex flex-column">
          <nz-form-label [nzNoColon]="true" class="d-flex">
            Đại diện chi cục dự trữ nhà nước
          </nz-form-label>
          <div class="pd-b-16 d-flex" *ngFor="let item of listDaiDienChiCuc;let i = index">
            <input nz-input [(ngModel)]="item.daiDien"
              [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
            <div class="btn-plus"
              *ngIf="i == 0 && !(detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView)"
              (click)="addDaiDien(capChiCuc)">
              <i class="icon htvbdh_dau-cong"></i>
            </div>
            <div class="btn-plus"
              *ngIf="i != 0 && !(detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView)"
              (click)="xoaDaiDien(item)">
              <i class="fa fa-trash-o do"></i>
            </div>
          </div>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item class="d-flex flex-column">
          <nz-form-label [nzNoColon]="true" class="d-flex">
            Đại diện đơn vị cung cấp
          </nz-form-label>
          <div class="pd-b-16 d-flex" *ngFor="let item of listDaiDienDonVi;let i = index">
            <input nz-input [(ngModel)]="item.daiDien"
              [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView" />
            <div class="btn-plus"
              *ngIf="i == 0 && !(detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView)"
              (click)="addDaiDien(capDonVi)">
              <i class="icon htvbdh_dau-cong"></i>
            </div>
            <div class="btn-plus"
              *ngIf="i != 0 && !(detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView)"
              (click)="xoaDaiDien(item)">
              <i class="fa fa-trash-o do"></i>
            </div>
          </div>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="24">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true" class="title-form-chi-tiet">
            2. Nội dung kiểm tra hồ sơ kỹ thuật
          </nz-form-label>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="4">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Tên hàng
          </nz-form-label>
          <nz-input-group nzAddOnAfterIcon="folder-open" (click)="selectHangHoa()">
            <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenVatTuCha" readonly="true" />
          </nz-input-group>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="4">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Chủng loại hàng
          </nz-form-label>
          <nz-input-group nzAddOnAfterIcon="folder-open" (click)="selectHangHoa()">
            <input class="search__input" [readonly]="true" nz-input [(ngModel)]="detail.tenVatTu" readonly="true" />
          </nz-input-group>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Số lượng thực nhập
          </nz-form-label>
          <nz-input-number type="text" nz-input
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView"
            [nzSize]="'small'" [(ngModel)]="detail.soLuongThucNhap" [nzMin]="0" [nzMax]="globals.prop.MAX_INPUT">
          </nz-input-number>
        </nz-form-item>
      </div>
      <div nz-col nzSpan="8">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Thời gian nhập
          </nz-form-label>
          <nz-date-picker nzShowTime nzFormat="yyyy-MM-dd HH:mm:ss" [(ngModel)]="detail.thoiGianNhap"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView">
          </nz-date-picker>
        </nz-form-item>
      </div>
    </div>
    <div class="comment-last" nz-row [nzGutter]="[18, 6]">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            Căn cứ pháp lý
          </nz-form-label>

        </nz-form-item>
        <div class="list-file">
          <file-list [data]="listCanCu"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView">
          </file-list>
        </div>
      </div>
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label [nzNoColon]="true">
            File đính kèm khác
          </nz-form-label>

        </nz-form-item>
        <div class="list-file">
          <file-list [data]="listFileDinhKem"
            [disabled]="detail.trangThai == globals.prop.NHAP_CHO_DUYET_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_TP || detail.trangThai == globals.prop.NHAP_TU_CHOI_LD_CUC || isView">
          </file-list>
        </div>
      </div>
    </div>
    <div nz-col nzSpan="24">
      <nz-form-item>
        <nz-form-label [nzNoColon]="true" class="title-form-chi-tiet">
          3. Kết luận
        </nz-form-label>
      </nz-form-item>
    </div>
    <div nz-col nzSpan="24">
      <nz-form-item class="d-flex flex-column">
        <nz-form-label [nzNoColon]="true" class="d-flex">
          Kết luận
        </nz-form-label>
        <textarea nz-input [rows]="3" [(ngModel)]="detail.ketLuan" placeholder="Nhập nội dung kết luận"></textarea>
      </nz-form-item>
    </div>
  </nz-card>
</div>