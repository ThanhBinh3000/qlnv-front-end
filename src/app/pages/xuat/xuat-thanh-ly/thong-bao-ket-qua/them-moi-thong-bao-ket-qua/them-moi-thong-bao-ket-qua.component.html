<nz-affix [nzOffsetTop]="globals.prop.MENU_LV1" class="btn-affix level1">
  <div class="btn-group">
    <button type="button" class="btn btn-sub" (click)="quayLai()">
      <i class="fa fa-arrow-left"></i>
      <span>Quay lại</span>
    </button>
    <button
      *ngIf="(formData.value.trangThai == STATUS.DU_THAO ||
       formData.value.trangThai == STATUS.TU_CHOI_LDV)&& userService.isAccessPermisson('XHDTQG_XCTVTXC_XC_QDXC_TAOQDXC')"
      type="button" class="btn btn-sub"
      (click)="saveAndSend(formData.value, STATUS.DA_HOAN_THANH, 'Bạn có muốn hoàn thành thông báo ?')">
      <i class="icon htvbdh_checkfile2"></i>
      <span>Hoàn thành</span>
    </button>
    <button
      *ngIf=" !isView && (formData.value.trangThai == STATUS.DU_THAO || formData.value.trangThai == STATUS.TU_CHOI_LDV || formData.value.trangThai == STATUS.TU_CHOI_LDC || formData.value.trangThai == STATUS.TU_CHOI_TP)"
      type="button" class="btn btn-main" (click)="save()">
      <i class="icon htvbdh_tcdt_save"></i>
      <span>Lưu</span>
    </button>
  </div>
</nz-affix>
<div class="bg-trang">
  <!--  Start Thông tin quyết định phê duyệt-->
  <div class="header header-green-background">
    <div class="header-text">
      <div class="title-chi-tieu">
        <span [ngClass]="formData.value.trangThai == STATUS.BAN_HANH ? 'da-ban-hanh' : 'du-thao-va-lanh-dao-duyet'">
          {{ formData.value.tenTrangThai }}
        </span>
        <span> THÔNG BÁO KẾT QUẢ TRÌNH HỒ SƠ THANH LÝ HÀNG DTQG </span>
      </div>
    </div>
  </div>
  <nz-alert *ngIf="formData.value.trangThai == STATUS.TU_CHOI_LDV " nzShowIcon nzType="error" nzMessage="Lý do từ chối"
            nzDescription="{{formData.value.lyDoTuChoi}}">
  </nz-alert>
  <nz-card class="mg-t-16 flex-card p-lr16">
    <nz-collapse nzAccordion>
      <div class="mt16 flex-card p-lr16">
        <div class="header header-green-background mg-t-16">
          <div class="header-text">
            <div class="title-chi-tieu">
              <span></span>
              <span>Thông tin chung</span>
            </div>
          </div>
        </div>
      </div>
      <form nz-form nzLayout="vertical" [formGroup]="formData">
        <div nz-row [nzGutter]="24">
          <div nz-col [nzSpan]="3">
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true"> Số quyết định thông báo KQ trình hồ sơ</nz-form-label>
              <nz-form-control [nzErrorTip]="error">
                <nz-input-group nzAddOnAfter="{{maHauTo}}">
                  <nz-input-number formControlName="soThongBao" [nzMin]="1" [nzMax]="999999999999" [nzStep]="1"
                                   [nzSize]="'small'"
                                   [nzDisabled]="isView">
                  </nz-input-number>
                </nz-input-group>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="3">
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true"> Ngày thông báo</nz-form-label>
              <nz-form-control [nzErrorTip]="error">
                <nz-date-picker formControlName="ngayThongBao" [nzFormat]="globals.dateFormat" [nzDisabled]="isView">
                </nz-date-picker>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div [nzSpan]="3" nz-col>
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true"> Số hồ sơ đề nghị thanh lý</nz-form-label>
              <nz-form-control [nzErrorTip]="error" nz-col nzSpan="24">
                <nz-select (ngModelChange)="changeHoSo($event)" [nzDisabled]="isView" formControlName="idHoSo"
                           nzAllowClear nzShowSearch>
                  <nz-option *ngFor="let p of listHoSo" [nzLabel]="p.soHoSo" [nzValue]="p.id"></nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="3">
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true"> Ngày trình duyệt HS thanh lý</nz-form-label>
              <nz-form-control [nzErrorTip]="error">
                <nz-date-picker formControlName="ngayThongBao" [nzFormat]="globals.dateFormat" [nzDisabled]="isView">
                </nz-date-picker>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="3">
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true"> Ngày thẩm định HS thanh lý</nz-form-label>
              <nz-form-control [nzErrorTip]="error">
                <nz-date-picker formControlName="ngayThongBao" [nzFormat]="globals.dateFormat" [nzDisabled]="isView">
                </nz-date-picker>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="3">
            <nz-form-item>
              <nz-form-label [nzNoColon]="true">
                Trạng thái
              </nz-form-label>
              <nz-form-control>
               <span>{{formData.value.trangThaiTb}}</span>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="24">
            <nz-form-item>
              <nz-form-label nzRequired [nzNoColon]="true">
                Nội dung báo cáo
              </nz-form-label>
              <nz-form-control nz-col [nzErrorTip]="error">
                            <textarea [readonly]="isView" nz-input [rows]="3"
                                      formControlName="noiDung"></textarea>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="24">
            <nz-form-item>
              <nz-form-label  [nzNoColon]="true">
                Lý do không phê duyệt của BTC
              </nz-form-label>
              <nz-form-control nz-col [nzErrorTip]="error">
                            <textarea [readonly]="isView" nz-input [rows]="3"
                                      formControlName="lyDo"></textarea>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div nz-col [nzSpan]="24">
            <nz-form-item>
              <nz-form-label [nzNoColon]="true">
                Tài liệu đính kèm thông báo đã ký
              </nz-form-label>
              <div class="list-file">
                <file-list [data]="formData.value.fileDinhKem" [isViewDetail]="isView"></file-list>
              </div>
            </nz-form-item>
          </div>
        </div>
      </form>
    </nz-collapse>
  </nz-card>
  <ng-template #error let-control>
    <app-template-error #error [control]="control"></app-template-error>
  </ng-template>
</div>
