<nz-table #basicTable nzBordered [nzData]="dataTable" [nzFrontPagination]="false" [nzShowPagination]="false">
    <thead>
        <tr>
            <th style="width: 2%;">STT</th>
            <th *ngIf="!isTableKetQua">Tên đơn vị thẩm định</th>
            <th *ngIf="isTableKetQua">Tên đơn vị báo giá</th>
            <th *ngIf="isTableKetQua">Chủng loại hàng hóa, tiêu chuẩn chất lượng</th>
            <th>Đơn giá chưa VAT (đồng/kg)</th>
            <th >Đơn giá có VAT (đồng/kg)</th>
            <th *ngIf="isTableKetQua">Thời hạn báo giá</th>
            <th>File đính kèm</th>
            <th *ngIf="isTableKetQua">Ghi chú</th>
            <th style="width: 8%;">Hành động</th>
        </tr>
        <tr>
            <th class="text-center"> </th>
            <th *ngIf="!isTableKetQua">
                <input type="text" [(ngModel)]="rowItem.tenDviThamDinh" nz-input />
            </th>
          <th *ngIf="isTableKetQua">
            <input type="text" [(ngModel)]="rowItem.tenDviBaoGia" nz-input />
          </th>
            <th *ngIf="isTableKetQua">
                <input type="text" [(ngModel)]="rowItem.cloaiVthh" nz-input />
            </th>
            <th>
                <nz-input-number [nzSize]="'small'" [(ngModel)]="rowItem.donGia" [nzFormatter]="globals.formatter"
                    [nzParser]="globals.parser">
                </nz-input-number>
            </th>
            <th>
                <nz-input-number disabled [nzSize]="'small'" [(ngModel)]=" rowItem.donGia + rowItem.donGia * vat" [nzFormatter]="globals.formatter"
                    [nzParser]="globals.parser">
                </nz-input-number>
            </th>
            <th *ngIf="isTableKetQua">
                <input type="text" [(ngModel)]="rowItem.thoiHanBaoGia" nz-input />
            </th>
            <th>
                <nz-form-control>
                    <nz-input-group nzSize="large" [nzAddOnAfter]="suffixIcon">
                        <input placeholder="Chọn file" [(ngModel)]="rowItem.fileDinhKem.fileName" nz-input disabled />
                    </nz-input-group>
                    <ng-template #suffixIcon>
                        <i class="icon htvbdh_tcdt_tep"></i>
                        <input class="input-file" (change)="getNameFile($event)" type="file" />
                    </ng-template>
                </nz-form-control>
            </th>

            <th *ngIf="isTableKetQua">
                <input type="text" [(ngModel)]="rowItem.ghiChu" nz-input />
            </th>
            <th style="text-align: center">
                <a>
                    <i class="icon htvbdh_dau-cong" (click)="themDataTable()"></i>
                </a>
                <a>
                    <i class="icon  htvbdh_nhap-lai1 "></i>
                </a>
            </th>
        </tr>
    </thead>
    <tbody >
        <tr *ngFor="let data of dataTable; let idx = index">
          <ng-container *ngIf="(dataEdit && dataEdit[idx] && !dataEdit[idx].edit) ; else editTemplate ">
            <td class="text-center">{{ idx + 1 }}</td>
            <td *ngIf="isTableKetQua">{{ data.tenDviBaoGia }}</td>
            <td *ngIf="!isTableKetQua">{{ data.tenDviThamDinh }}</td>
            <td *ngIf="isTableKetQua">{{ data.cloaiVthh }}</td>
            <td>{{data.donGia | number : '1.0-1' : 'vi_VN' }}</td>
            <td >{{data.donGiaVat | number : '1.0-1' : 'vi_VN' }}</td>
            <td *ngIf="isTableKetQua">{{data.thoiHanBaoGia }}</td>
            <td>{{data.fileDinhKem?.fileName }}</td>
            <td *ngIf="isTableKetQua">{{data.ghiChu }}</td>
            <td style="text-align: center">
                <a (click)="downloadFile(data.fileDinhKem)">
                    <i class="icon htvbdh_tcdt_import "></i>
                </a>
                <a *ngIf="!isView" (click)="editRow(idx)">
                    <i class="fa fa-pencil"></i>
                </a>
                <a *ngIf="!isView" (click)="deleteItem(idx)">
                    <i class="fa fa-trash-o do"></i>
                </a>
            </td>
          </ng-container>
          <ng-template #editTemplate>
          <td class="text-center"> </td>
          <td *ngIf="!isTableKetQua">
            <input type="text" [(ngModel)]="dataEdit[idx].data.tenDviThamDinh" nz-input />
          </td>
          <td *ngIf="isTableKetQua">
            <input type="text" [(ngModel)]="dataEdit[idx].data.tenDviBaoGia" nz-input />
          </td>
          <td *ngIf="isTableKetQua">
            <input type="text" [(ngModel)]="dataEdit[idx].data.cloaiVthh" nz-input />
          </td>
          <td>
            <nz-input-number [nzSize]="'small'" [(ngModel)]="dataEdit[idx].data.donGia" [nzFormatter]="globals.formatter"
                             [nzParser]="globals.parser">
            </nz-input-number>
          </td>
          <td>
            <nz-input-number disabled [nzSize]="'small'" [(ngModel)]="dataEdit[idx].data.donGia * vat + dataEdit[idx].data.donGia" [nzFormatter]="globals.formatter"
                             [nzParser]="globals.parser">
            </nz-input-number>
          </td>
          <td *ngIf="isTableKetQua">
            <input type="text" [(ngModel)]="dataEdit[idx].data.thoiHanBaoGia" nz-input />
          </td>
          <td>
            <nz-form-control>
              <nz-input-group nzSize="large" [nzAddOnAfter]="suffixIcon">
                <input placeholder="Chọn file" [(ngModel)]="dataEdit[idx].data.fileDinhKem.fileName" nz-input disabled />
              </nz-input-group>
              <ng-template #suffixIcon>
                <i class="icon htvbdh_tcdt_tep"></i>
                <input class="input-file" (change)="getNameFile($event, '',null,dataEdit[idx].data )" type="file" />
              </ng-template>
            </nz-form-control>
          </td>
          <td *ngIf="isTableKetQua" >
            <input type="text" [(ngModel)]="dataEdit[idx].data.ghiChu" nz-input />
          </td>
            <td style="text-align: center">
              <a (click)="downloadFile(dataEdit[idx].data.fileDinhKem)">
                <i class="icon htvbdh_tcdt_import "></i>
              </a>
              <a (click)="saveEdit(idx)" class="save">
                <i class="fa fa-save"></i>
              </a>
              <a (click)="cancelEdit(idx)">
                <i class="fa fa-ban do"></i> </a>
            </td>
          </ng-template>
        </tr>
    </tbody>
</nz-table>
