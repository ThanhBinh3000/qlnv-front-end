<div class="contentBor chi-tieu__body">
    <div class="contentDetail">
        <div class="main-content thong-tin-de-xuat-khlcnt">
            <nz-card nzTitle="NHẬP ĐỀ XUẤT" class="mt16 flex-card p-lr16 mb16" [nzExtra]="tableCard1">
                <form [nzLayout]="'vertical'" nz-form [formGroup]="formData" class="mt-16">
                    <div nz-row [nzGutter]="[16, 12]">
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Số quyết định phê duyệt kết quả LCNT
                                </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="soDeXuatError">
                                    <nz-input-group nzAddOnAfter="/DX-TCDT">
                                        <nz-input-number formControlName="soDxuat" [nzMin]="1" [nzMax]="9999999"
                                            [nzStep]="1" [nzSize]="'small'"
                                            [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''">
                                        </nz-input-number>
                                    </nz-input-group>
                                    <ng-template #soDeXuatError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Ngày quyết định phê duyệt kết quả LCNT
                                </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="ngayKyError">
                                    <nz-input-group>
                                        <nz-date-picker class="search__input"
                                            [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''"
                                            formControlName="ngayKy" nzFormat="dd/MM/yyyy"
                                            [nzDisabled]="chiTietThongTinDXKHLCNT.trangThai === '02' || chiTietThongTinDXKHLCNT.trangThai === '01'">
                                        </nz-date-picker>
                                    </nz-input-group>
                                    <ng-template #ngayKyError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Ngày hiệu lực</nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="ngayKyError">
                                    <nz-input-group>
                                        <nz-date-picker class="search__input"
                                            [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''"
                                            formControlName="ngayKy" nzFormat="dd/MM/yyyy"
                                            [nzDisabled]="chiTietThongTinDXKHLCNT.trangThai === '02' || chiTietThongTinDXKHLCNT.trangThai === '01'">
                                        </nz-date-picker>
                                    </nz-input-group>
                                    <ng-template #ngayKyError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Năm kế hoạch </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="namKhoachError">
                                    <nz-select formControlName="namKhoach"
                                        [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''">
                                        <nz-option *ngFor="let p of listNam" [nzValue]="p.value" [nzLabel]="p.text">
                                        </nz-option>
                                    </nz-select>
                                    <ng-template #namKhoachError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label [nzNoColon]="true"> Loại hàng hóa </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="loaiVthhError">
                                    <nz-select nzPlaceHolder="Loại hàng DTQG" formControlName="loaiVthh" nzDisabled>
                                        <nz-option *ngFor="let p of listVthh" [nzValue]="p.value" [nzLabel]="p.text">
                                        </nz-option>
                                    </nz-select>
                                    <ng-template #loaiVthhError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="24">
                            <nz-form-item>
                                <nz-form-label [nzNoColon]="true"> Về việc </nz-form-label>
                                <textarea nz-input [rows]="3" formControlName="trichYeu" name="trichYeu"
                                    [readonly]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''"
                                    [ngClass]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== '' ? 'disable' : ''"></textarea>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Số quyết định phê duyệt kết quả LCNT
                                </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="soDeXuatError">
                                    <nz-select formControlName="namKhoach"
                                        [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''">
                                        <nz-option *ngFor="let p of listPheDuyetKhlcnt" [nzValue]="p.soQd"
                                            [nzLabel]="p.soQd">
                                        </nz-option>
                                    </nz-select>
                                    <ng-template #soDeXuatError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Ngày quyết định phê duyệt kết quả LCNT
                                </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="ngayKyError">
                                    <nz-input-group>
                                        <nz-date-picker class="search__input"
                                            [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''"
                                            formControlName="ngayKy" nzFormat="dd/MM/yyyy"
                                            [nzDisabled]="chiTietThongTinDXKHLCNT.trangThai === '02' || chiTietThongTinDXKHLCNT.trangThai === '01'">
                                        </nz-date-picker>
                                    </nz-input-group>
                                    <ng-template #ngayKyError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="12">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Ngày hiệu lực</nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="ngayKyError">
                                    <nz-input-group>
                                        <nz-date-picker class="search__input"
                                            [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''"
                                            formControlName="ngayKy" nzFormat="dd/MM/yyyy"
                                            [nzDisabled]="chiTietThongTinDXKHLCNT.trangThai === '02' || chiTietThongTinDXKHLCNT.trangThai === '01'">
                                        </nz-date-picker>
                                    </nz-input-group>
                                    <ng-template #ngayKyError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                    </div>
                    <div nz-row [nzGutter]="[16, 12]">
                        <div nz-col [nzSpan]="6">
                            <nz-upload nzAction="{{urlUploadFile}}" [nzFileList]="fileList" [nzMultiple]="true"
                                [nzSize]="1024" (nzChange)="handleChange($event)" [nzFileListRender]="fileListTpl"
                                nzAccept="application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                                [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''">
                                <button class="btn btn-tep btn-sm waves-effect waves-light mt-1">
                                    <i class="icon htvbdh_tcdt_tep"></i>
                                    <span>File đính kèm</span>
                                </button>
                                <ng-template #fileListTpl let-list>
                                    <nz-list>
                                        <nz-list-item *ngFor="let item of list">
                                            <div class="trai">
                                                {{ item.name }}
                                            </div>
                                            <div class="phai">
                                                <a (click)="xoaFile(item)">
                                                    <i class="fa fa-trash-o do"></i>
                                                </a>
                                            </div>
                                        </nz-list-item>
                                    </nz-list>
                                </ng-template>
                            </nz-upload>
                        </div>
                    </div>
                    <div nz-row [nzGutter]="[16, 12]">
                        <div nz-col [nzSpan]="8">
                            <nz-form-item>
                                <nz-form-label [nzNoColon]="true"> Trúng / Hủy thầu </nz-form-label>
                                <nz-radio-group>
                                    <label nz-radio nzValue="trung">Xác định được đơn vị trúng thầu</label>
                                    <label nz-radio nzValue="huy">Hủy thầu</label>
                                </nz-radio-group>
                            </nz-form-item>
                        </div>
                    </div>
                    <div nz-row [nzGutter]="[24]">
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Năm kế hoạch </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="namKhoachError">
                                    <nz-select formControlName="namKhoach"
                                        [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''">
                                        <nz-option *ngFor="let p of listNam" [nzValue]="p.value" [nzLabel]="p.text">
                                        </nz-option>
                                    </nz-select>
                                    <ng-template #namKhoachError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label [nzNoColon]="true"> Loại hàng hóa </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="loaiVthhError">
                                    <nz-select nzPlaceHolder="Loại hàng DTQG" formControlName="loaiVthh" nzDisabled>
                                        <nz-option *ngFor="let p of listVthh" [nzValue]="p.value" [nzLabel]="p.text">
                                        </nz-option>
                                    </nz-select>
                                    <ng-template #loaiVthhError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label nzRequired [nzNoColon]="true"> Năm kế hoạch </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="namKhoachError">
                                    <nz-select formControlName="namKhoach"
                                        [nzDisabled]="formData.value.trangThai !== '00' && formData.value.trangThai !== '03' && formData.value.trangThai !== ''">
                                        <nz-option *ngFor="let p of listNam" [nzValue]="p.value" [nzLabel]="p.text">
                                        </nz-option>
                                    </nz-select>
                                    <ng-template #namKhoachError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="6">
                            <nz-form-item class="display-block">
                                <nz-form-label [nzNoColon]="true"> Loại hàng hóa </nz-form-label>
                                <nz-form-control nz-col [nzSpan]="24" [nzErrorTip]="loaiVthhError">
                                    <nz-select nzPlaceHolder="Loại hàng DTQG" formControlName="loaiVthh" nzDisabled>
                                        <nz-option *ngFor="let p of listVthh" [nzValue]="p.value" [nzLabel]="p.text">
                                        </nz-option>
                                    </nz-select>
                                    <ng-template #loaiVthhError let-control>
                                        <ng-container *ngIf="control.hasError('required')">{{errorInputRequired}}
                                        </ng-container>
                                    </ng-template>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                        <div nz-col [nzSpan]="24">
                            <nz-form-item>
                                <nz-form-label nzRequired [nzNoColon]="true"> Ghi chú </nz-form-label>
                                <textarea nz-input [rows]="3"></textarea>
                            </nz-form-item>
                        </div>
                    </div>
                </form>
            </nz-card>
        </div>
    </div>
</div>
<ng-template #tableCard1>
    <button *ngIf="formData.value.trangThai == ''" type="button" class="btn btn-main" (click)="save()">
        <i class="icon htvbdh_dau-cong"></i>
        <span>Thêm</span>
    </button>
    <button *ngIf="formData.value.trangThai == '00' || formData.value.trangThai == '03'" type="button"
        class="btn btn-main" (click)="save()">
        <i class="icon htvbdh_tcdt_save"></i>
        <span>Lưu</span>
    </button>
    <!-- 00 : Tạo mới , 01 Gửi duyệt chờ TP duyệt , 03 : Từ chối , 09 TP duyệt chờ LĐ duyệt -->
    <button
        *ngIf="formData.value.trangThai == '00' || formData.value.trangThai == '01' || formData.value.trangThai == '03' || formData.value.trangThai == '09' "
        type="button" class="btn btn-main" (click)="guiDuyet()">
        <i class="icon {{iconButtonDuyet}}"></i>
        <span>{{titleButtonDuyet}}</span>
    </button>
    <button *ngIf="formData.value.trangThai == '01' || formData.value.trangThai == '09' " type="button"
        class="btn btn-sub" (click)="tuChoi()">
        <i class="icon htvbdh_tcdt_tuchoi do"></i>
        <span>Từ chối</span>
    </button>
    <button type="button" class="btn btn-sub" (click)="quayLai()">
        <i class="fa fa-arrow-left"></i>
        <span>Quay lại</span>
    </button>
</ng-template>