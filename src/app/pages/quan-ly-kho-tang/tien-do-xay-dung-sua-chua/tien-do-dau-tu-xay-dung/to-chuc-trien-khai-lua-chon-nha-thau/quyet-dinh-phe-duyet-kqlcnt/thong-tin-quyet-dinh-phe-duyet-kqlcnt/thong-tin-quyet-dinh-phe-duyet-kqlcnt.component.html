<div class="bg-trang">
  <div class="header header-green-background">
    <div class="header-text">
      <div class="title-chi-tieu">
        <span
          [ngClass]="formData.value.trangThai == STATUS.BAN_HANH  ? 'da-ban-hanh' : 'du-thao-va-lanh-dao-duyet'">
          {{ formData.value.tenTrangThai }}
        </span>
        <span class="text-uppercase">Quyết định phê duyệt kết quả lựa chọn nhà thầu</span>
      </div>
    </div>
    <div class="btn-group">
      <button type="button" class="btn btn-sm ml-2" (click)="goBack()">
        <i class="fa fa-arrow-left"></i>
        <span>Quay lại</span>
      </button>
      <button class="btn btn-sub xanh-nhat ml-2" (click)="banHanh(idInput)"
              *ngIf="(idInput && idInput > 0) && (formData.value.trangThai == STATUS.DU_THAO) ">
        <i class="icon htvbdh_tcdt_pheduyet"></i>
        <span>Ban hành</span>
      </button>
      <button (click)="save()"
              *ngIf="(formData.value.trangThai == STATUS.DU_THAO)  "
              class="btn btn-main btn-sm waves-effect waves-light ml-2">
        <i class="icon htvbdh_tcdt_save"></i>
        <span>Lưu</span>
      </button>
    </div>
  </div>
  <nz-alert *ngIf="formData.value.trangThai == STATUS.TUCHOI_CB_CUC " nzShowIcon nzType="error"
            nzMessage="Lý do từ chối"
            nzDescription="{{formData.value.lyDoTuChoi}}">
  </nz-alert>
  <nz-card class="mt16 flex-card p-lr16 mg-t-10">
    <form nz-form nzLayout="vertical" [formGroup]="formData">
      <div nz-row [nzGutter]="24">
        <div nz-col nzSpan="4">
          <nz-form-item>
            <nz-form-control [nzErrorTip]="error">
              <nz-form-label nzRequired [nzNoColon]="true" class="label-color-kh"> Số quyết định</nz-form-label>
              <nz-input-group [nzAddOnAfter]="maQd">
                <input nz-input formControlName="soQd" [readonly]="isViewDetail"/>
              </nz-input-group>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="4">
          <nz-form-item>
            <nz-form-control [nzErrorTip]="error">
              <nz-form-label nzRequired [nzNoColon]="true" class="label-color-kh">Số QĐ phê duyệt dự án ĐTXD
              </nz-form-label>
              <nz-select nzAllowClear (ngModelChange)="changeSoQdPdDaDtxd($event)" formControlName="soQdPdDaDtxd"
                         [nzDisabled]="isViewDetail ||  idInput > 0">
                <nz-option *ngFor="let p of listQdPdDaDtxd" [nzValue]="p.soQd"
                           [nzLabel]="p.soQd"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-control [nzErrorTip]="error">
              <nz-form-label nzRequired [nzNoColon]="true" class="label-color-kh">Tên dự án
              </nz-form-label>
              <input nz-input formControlName="tenDuAn" [readonly]="true"/>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="6">
          <nz-form-item>
            <nz-form-control [nzErrorTip]="error">
              <nz-form-label nzRequired [nzNoColon]="true" class="label-color-kh">Chủ đầu tư
              </nz-form-label>
              <input nz-input formControlName="chuDauTu" [readonly]="true"/>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="4">
          <nz-form-item>
            <nz-form-control [nzErrorTip]="error">
              <nz-form-label nzRequired [nzNoColon]="true" class="label-color-kh"> Ngày ký</nz-form-label>
              <nz-date-picker [nzDisabled]="isViewDetail" class="search__input" nzFormat="dd/MM/YYYY"
                              nzPlaceHolder="Ngày ký"
                              formControlName="ngayKy">
              </nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="24">
          <nz-form-item>
            <nz-form-control [nzErrorTip]="error">
              <nz-form-label nzRequired [nzNoColon]="true" class="label-color-kh"> Trích yếu</nz-form-label>
              <input nz-input formControlName="trichYeu" [readonly]="isViewDetail"/>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="4">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" class="label-color-kh"> Phần công việc đã thực hiện (đ)</nz-form-label>
            <nz-form-control nz-col [nzSpan]="24">
              <span class="text-green" nzDisabled>{{formData.value.tienCvDaTh | number: '1.0-1'}}</span>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="5">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" class="label-color-kh"> Phần công việc không áp dụng được một trong các
              hình thức lựa chọn nhà thầu (đ)
            </nz-form-label>
            <nz-form-control nz-col [nzSpan]="24">
              <span class="text-green" nzDisabled>{{formData.value.tienCvKad | number: '1.0-1'}}</span>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="5">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" class="label-color-kh"> Phần công việc thuộc kế hoạch lựa chọn nhà thầu
              (đ)
            </nz-form-label>
            <nz-form-control nz-col [nzSpan]="24">
              <span class="text-green" nzDisabled>{{formData.value.tienCvKhlcnt | number: '1.0-1'}}</span>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="5">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" class="label-color-kh"> Phần công việc chưa đủ điều kiện lập kế hoạch lựa
              chọn nhà thầu (đ)
            </nz-form-label>
            <nz-form-control nz-col [nzSpan]="24">
              <span class="text-green"
                    nzDisabled>{{formData.value.tongTien - (formData.value.tienCvKhlcnt + formData.value.tienCvKad + formData.value.tienCvDaTh) | number: '1.0-1'}}</span>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="5">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true" class="label-color-kh"> Tổng hợp giá trị của các phần công việc (đ)
            </nz-form-label>
            <nz-form-control nz-col [nzSpan]="24">
              <span class="text-green" nzDisabled>{{formData.value.tongTien | number: '1.0-1'}}</span>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col nzSpan="24">
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">
              Tài liệu đính kèm
            </nz-form-label>
            <div class="list-file">
              <file-list [data]="fileDinhKem"></file-list>
            </div>
          </nz-form-item>
        </div>
      </div>
    </form>
  </nz-card>
</div>
<ng-template #error let-control>
  <ng-container *ngIf="control.hasError('required')">{{globals.prop.REQUIRED}}
  </ng-container>
</ng-template>
