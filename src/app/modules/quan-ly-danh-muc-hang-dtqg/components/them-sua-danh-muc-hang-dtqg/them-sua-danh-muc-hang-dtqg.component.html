<form (ngSubmit)="submitForm()" #f="ngForm" novalidate>
    <ng-container *ngIf="smallScreen$ | async as smallScreen">
        <mat-card class="mat-elevation-z-p-r6" [ngClass]="'mat-elevation-z0'">
            <mat-card-header>
                <mat-card-title> {{ data.title }} </mat-card-title>
            </mat-card-header>
            <mat-card-content class="content-container">
                <ng-container *ngIf="smallScreen === 'no'" [formGroup]="form">
                    <div class="container-create-user user-form-wrapper">
                        <div fxLayout="column" fxLayoutAlign="space-around center" fxLayoutGap="40px">
                            <div fxLayout="row" fxLayoutAlign="space-around center" fxLayoutGap="40px">
                                <div class="user-item">
                                    <div class="form-field-label">User Name
                                        <strong style="color: #ff1744">*</strong>
                                    </div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <input matInput type="text" placeholder="User Name"
                                                formControlName="username" autocomplete="off"
                                                [(ngModel)]="data.username" (ngModelChange)="userNameChanged($event)" />
                                            <mat-error *ngIf="username.errors && username.errors['required']">
                                                Please input your user name
                                            </mat-error>
                                            <mat-error *ngIf="username.errors && username.errors['username']">
                                                Please input a valid user name
                                            </mat-error>
                                            <mat-error *ngIf="username.errors && username.errors['taken']">
                                                This user name is already existed
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="user-item">
                                    <div class="form-field-label">Email
                                        <strong style="color: #ff1744">*</strong>
                                    </div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <input matInput required type="email" placeholder="Email"
                                                formControlName="email" autocomplete="off" [(ngModel)]="data.email"
                                                (ngModelChange)="emailChanged($event)" [errorStateMatcher]="matcher" />
                                            <mat-error *ngIf="email.errors && email.errors['required']">
                                                Please input your email
                                            </mat-error>
                                            <mat-error *ngIf="email.errors && email.errors['email']">
                                                Please input a valid email
                                            </mat-error>
                                            <mat-error *ngIf="email.errors && email.errors['taken']">
                                                This email is already existed
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="space-around center" fxLayoutGap="40px">
                                <div class="user-item">
                                    <div class="form-field-label">First Name
                                        <strong style="color: #ff1744">*</strong>
                                    </div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <input matInput type="text" placeholder="First Name"
                                                formControlName="firstname" autocomplete="off"
                                                [(ngModel)]="data.firstname" />
                                            <mat-error *ngIf="firstname.errors && firstname.errors['required']">
                                                Please input your first name
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="user-item">
                                    <div class="form-field-label">Last Name
                                        <strong style="color: #ff1744">*</strong>
                                    </div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <input matInput type="text" placeholder="Last Name"
                                                formControlName="lastname" autocomplete="off"
                                                [(ngModel)]="data.lastname" />
                                            <mat-error *ngIf="lastname.errors && lastname.errors['required']">
                                                Please input your last name
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="space-around center" fxLayoutGap="40px">
                                <div class="user-item">
                                    <div class="form-field-label">Phone Number
                                        <strong style="color: #ff1744">*</strong>
                                    </div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <input matInput type="text" placeholder="Phone Number"
                                                formControlName="phoneNumber" autocomplete="off"
                                                [(ngModel)]="data.phoneNumber" />
                                            <mat-error *ngIf="phoneNumber.errors && phoneNumber.errors['required']">
                                                Please input your phone number.
                                            </mat-error>
                                            <mat-error *ngIf="phoneNumber.errors && phoneNumber.errors['phoneNumber']">
                                                Please input a valid phone number
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="user-item">
                                    <div class="form-field-label">Address</div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <input matInput type="text" placeholder="Address" formControlName="address"
                                                autocomplete="off" [(ngModel)]="data.address" />
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="space-around center" fxLayoutGap="40px">
                                <div class="user-item">
                                    <div class="form-field-label">Gender
                                        <strong style="color: #ff1744">*</strong>
                                    </div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <mat-select formControlName="genderId" placeholder="Choose Gender..."
                                                [value]="data.genderId">
                                                <mat-option *ngFor="let itemGender of (lstGenders | async)"
                                                    [value]="itemGender.id">
                                                    {{ itemGender.value }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="genderId.errors && genderId.errors['required']">
                                                Please input your gender
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="user-item">
                                    <div class="form-field-label">Date of birth</div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <input matInput [matDatepicker]="picker" placeholder="Choose A Date"
                                                formControlName="dob" [(ngModel)]="data.dob">
                                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                            <mat-datepicker #picker></mat-datepicker>
                                            <mat-error *ngIf="dob.errors && dob.errors['matDatepickerParse'] != null">
                                                Please input a valid date of birth
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="space-around center" fxLayoutGap="40px">
                                <div class="user-item">
                                    <div class="form-field-label">Country
                                        <strong style="color: #ff1744">*</strong>
                                    </div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <mat-select formControlName="countryId" placeholder="Choose Country..."
                                                [value]="data.countryId">
                                                <mat-option *ngFor="let itemCountry of (lstCountries | async)"
                                                    [value]="itemCountry.id">
                                                    {{ itemCountry.name }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="countryId.errors && countryId.errors['required']">
                                                Please input your country
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="user-item">
                                    <div class="form-field-label">Education
                                        <strong style="color: #ff1744">*</strong>
                                    </div>
                                    <div class="item-group">
                                        <mat-form-field appearance="outline">
                                            <mat-select formControlName="educationId" placeholder="Choose Education..."
                                                [value]="data.educationId">
                                                <mat-option *ngFor="let itemEducation of (lstEducations | async)"
                                                    [value]="itemEducation.id">
                                                    {{ itemEducation.value }}
                                                </mat-option>
                                            </mat-select>
                                            <mat-error *ngIf="educationId.errors && educationId.errors['required']">
                                                Please input your education
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <app-error-box [errorMessages]="errorMessages"></app-error-box>
            </mat-card-content>
        </mat-card>
        <div class="button-group">
            <button style="float:right" mat-button type="button" class="mat-slim cancel" [mat-dialog-close]="false"
                [attr.aria-label]="'cancel navigation'" *ngIf="!data.hideCancelButton"
                (click)="closePopup()">
                Cancel
            </button>
            <button style="float:right;background-color: #0957DE;color: #fff;opacity: 0.5;border-color: #0957DE;border-radius: 12px;" mat-button color="primary" type="submit" [mat-dialog-close]="true"
                [attr.aria-label]="'Confirm navigation'" class="mat-slim confirm"
                [class]="form.valid ? 'btn-add-active' : ''" [disabled]="form.invalid">
                Submit
            </button>
        </div>
    </ng-container>
</form>
