<div nz-row nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzGutter="24">
  <div nz-col [nzSpan]="8">
    <nz-form-item>
      <nz-form-label nzRequired [nzNoColon]="true"> Cục DTNN KV </nz-form-label>
      <nz-select [(ngModel)]="cucDTNN">
        <nz-option *ngFor="let p of listDonVi" [nzValue]="p.maDvi" [nzLabel]="p.tenDvi">
        </nz-option>
      </nz-select>
    </nz-form-item>
  </div>
  <div nz-col [nzSpan]="24">
    <nz-form-item>
      <nz-form-label nzRequired [nzNoColon]="true"> Tên dự án </nz-form-label>
      <input nz-input [(ngModel)]="tenDuAn" />
    </nz-form-item>
  </div>
  <div nz-col [nzSpan]="24" class="mt-16">
    <div id="table-goi-thau">
      <nz-card nzTitle="Danh sách gói thầu" class="mt16 flex-card p-lr16 dialog-thong-tin-phu-luc">
        <nz-table #basicTable class="nowrap mt-16 flex-card p-lr16" [nzData]="dataTable">
          <thead>
            <tr>
              <th width="60px">STT</th>
              <th>Gói thầu</th>
              <th>Địa điểm nhập kho</th>
              <th>Số lượng (tấn)</th>
              <th>Đơn giá đã bao gồm VAT (đồng/kg)</th>
              <th>Thành tiền (đồng)</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of basicTable.data; let i = index">
              <ng-container *ngIf="!editCache[data.id].edit; else editTemplate">
                <td class="text-center">{{(page-1)*pageSize+i+1}}</td>
                <td>{{ data.goiThau }}</td>
                <td>{{ data.diaDiem }}</td>
                <td>{{ data.soLuong }}</td>
                <td>{{ data.donGia }}</td>
                <td>{{ data.thanhTien }}</td>
                <td class="text-center">
                  <a (click)="startEdit(data.id)">
                    <i class="fa fa-pencil"></i>
                  </a>
                  <a (click)="xoaItem(data)">
                    <i class="fa fa-trash-o do"></i>
                  </a>
                </td>
              </ng-container>
              <ng-template #editTemplate>
                <td><input type="text" nz-input [(ngModel)]="editCache[data.id].data.goiThau" /></td>
                <td><input type="text" nz-input [(ngModel)]="editCache[data.id].data.diaDiem" /></td>
                <td>
                  <nz-input-number [nzSize]="'small'" nz-input [(ngModel)]="editCache[data.id].data.soLuong"
                    [nzMin]="0">
                  </nz-input-number>
                </td>
                <td>
                  <nz-input-number [nzSize]="'small'" nz-input [(ngModel)]="editCache[data.id].data.donGia" [nzMin]="0">
                  </nz-input-number>
                </td>
                <td>
                  <nz-input-number [nzSize]="'small'" nz-input [(ngModel)]="editCache[data.id].data.thanhTien"
                    [nzMin]="0"></nz-input-number>
                </td>
                <td>
                  <a (click)="saveEdit(data.id)" class="save"><i nz-icon nzType="save"></i></a>
                  <a nz-popconfirm nzPopconfirmTitle="Bạn có chắc chắn muốn hủy?" (nzOnConfirm)="cancelEdit(data.id)">
                    <i nz-icon nzType="close"></i>
                  </a>
                </td>
              </ng-template>
            </tr>
            <tr *ngIf="dataTable?.length > 0">
              <td colspan="3" class="background-last-row align-right">Tổng</td>
              <td class="background-last-row">{{ tableExist ? reduceRowData(0, 3, 2, ',','table-goi-thau') : 0 | number:
                '1.0-1'}}</td>
              <td class="background-last-row">{{ tableExist ? reduceRowData(0, 3, 3, ',','table-goi-thau') : 0 | number:
                '1.0-1'}}</td>
              <td class="background-last-row">{{ tableExist ? reduceRowData(0, 3, 4, ',','table-goi-thau') : 0 | number:
                '1.0-1'}}</td>
              <td class="background-last-row"></td>
            </tr>
          </tbody>
        </nz-table>
        <div class="tab-content tab-menu" id="myTabContent">
          <div class="tab-pane fade show active justify-content-between">
            <div class="trai">
            </div>
            <div class="canphai">
              <!-- begin phân trang  -->
              <nz-pagination class="pagination-card" [nzPageIndex]="page" [nzTotal]="totalRecord" nzShowSizeChanger
                [nzPageSize]="pageSize" [nzShowTotal]="rangeTemplate" (nzPageIndexChange)="changePageIndex($event)"
                (nzPageSizeChange)="changePageSize($event)">
                <ng-template #rangeTemplate let-range="range" let-total>
                  {{ range[0] }}-{{ range[1] }} of {{ total }} items
                </ng-template>
              </nz-pagination>
              <!-- end phân trang  -->
            </div>
          </div>
        </div>
      </nz-card>
    </div>
  </div>
  <div nz-col [nzSpan]="24" class="mt-16">
    <nz-form-item>
      <nz-form-label nzRequired [nzNoColon]="true">
        Ghi chú
      </nz-form-label>
      <textarea nz-input [rows]="3" [(ngModel)]="ghiChu"></textarea>
    </nz-form-item>
  </div>
</div>
<div class="modal-footer">
  <div class="nut">
    <div class="cantrai">
    </div>
    <div class="canphai">
      <a class="btn btn-outline-grey btn-sm waves-effect waves-light" (click)="onCancel()">
        <i aria-hidden="true" class="fa fa-sign-out"></i>
        Đóng
      </a>
    </div>
  </div>
</div>